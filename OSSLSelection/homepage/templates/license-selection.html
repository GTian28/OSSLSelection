{% extends 'ossls_base.html' %}

{% block extraCSS %}
	<link rel="stylesheet" type="text/css" href="/static/css/component.css" />
	<link rel="stylesheet" href="/static/css/zTreeStyle/zTreeStyle.css">
	<!--[if IE]>
	<script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
	<![endif]-->
	<script>(function(e,t,n){var r=e.querySelectorAll("html")[0];r.className=r.className.replace(/(^|\s)no-js(\s|$)/,"$1js$2")})(document,window,0);</script>
{% endblock %}

{% block title %}
	开源许可证推荐
{% endblock %}

{% block title_instruction %}
<!--本工具的主要考虑了：</br>（自动化检测）开源许可证的兼容性；（观点参考）开源商业模式、项目社区发展、个人开源风格对许可证类型的影响；</br>-->
<!--（解读+偏好选择+细节对比）开源许可证要素分析；（推荐排序）许可证流行度和可读性.</br>-->
{% endblock %}

{% block beforebody %}
	<!--流程图标-->
	<div class="team-area" style="padding:30px 0" >
		<div align="center">
			<table border="0" style="width: 35%;text-align: left;position: relative;margin-left: 19px;margin:0px 0px 0 28px;">
				<tr style="height: 50px;">
					<td style="width: 140px">
						<div style="position:relative;">
							<img id="firstImg" style=" width: 250px;height: 34px;margin:0px 0px 0 0px;" src="/static/img/step1_select.png"/>
							<div style="position:absolute;z-indent:2;left:50px;top:0;">
								<span style="width: 71px;height: 14px;font-size: 16px;line-height: 32px;letter-spacing: 3px;color: #f9f9f9;">
								1 &nbsp;兼容性检查
							</span>
							</div>
						</div>
					</td>
					<td style="width: 140px">
						<div style="position:relative;">
							<img id="secondImg" style=" width: 250px;height: 34px;margin:0px 0px 0 0px;" src="/static/img/step2.png"/>
							<div style="position:absolute;z-indent:2;left:60px;top:0;">
								<span id="secondText" style="width: 71px;height: 14px;font-size: 16px;line-height: 32px;letter-spacing: 3px;color: #999999;">
								2 &nbsp;条款偏好选择
							</span>
							</div>
						</div>
					</td>
					<td style="width: 140px">
						<div style="position:relative;">
							<img id="thirdImg" style=" width: 250px;height: 34px;margin:0px 0px 0 0px;" src="/static/img/step2.png"/>
							<div style="position:absolute;z-indent:2;left:70px;top:0;">
								<span id="thirdText" style="width: 71px;height: 14px;font-size: 16px;line-height: 32px;letter-spacing: 3px;color: #999999;">
								3 &nbsp;细节对比
							</span>
							</div>
						</div>
					</td>
				</tr>
			</table>
		</div>
	</div>
{% endblock %}

{% block body %}

	<div id="flow_detail"  style="position:absolute;width:1280px;height:450px;z-index:999999;display:none;background:#def3f8;">
		<a id="close_detail" style="position:absolute;display:inline-block;margin:4px 0 0 1250px;width:20px;height:20px;line-height:25px;cursor:pointer;border:1px;vertical-align:top;text-align:left;">&#10006</a>
		<!--<table class="table-hover" id="detail_license_table" style="width: 100%; border-collapse:collapse;  border-spacing:0; "></table>-->
		<div><ul id="treeDemo" class="ztree"></ul></div>
	</div>
	<!--开源许可证推荐过程面板-->
	<div class="row">
		<!--左侧栏-->
		<div class="col-xl-9 col-lg-9 col-md-12 col-sm-12"  >
			<!--第一步：开源许可证识别及兼容性检查-->
			<div id="step1" style="display:block">
				<div class="row"  >
					<!--左一栏-->
					<div class="col-xl-7 col-lg-7 col-md-8 col-sm-8" >
						<div align="center" style="margin:10px 0px 25px 0px" >
							<h5>待开源项目包上传</h5>
						</div>
						<div class="box-file" align="center">
							<input type="file" name="file-5[]" id="file-5" class="inputfile inputfile-4" data-multiple-caption="{count} files selected" multiple />
							<label for="file-5"><figure><svg xmlns="http://www.jb51.net" width="20" height="17" viewBox="0 0 20 17"><path d="M10 0l-5.2 4.9h3.3v5.1h3.8v-5.1h3.3l-5.2-4.9zm9.3 11.5l-3.2-2.1h-2l3.4 2.6h-3.5c-.1 0-.2.1-.2.1l-.8 2.3h-6l-.8-2.2c-.1-.1-.1-.2-.2-.2h-3.6l3.4-2.6h-2l-3.2 2.1c-.4.3-.7 1-.6 1.5l.6 3.1c.1.5.7.9 1.2.9h16.3c.6 0 1.1-.4 1.3-.9l.6-3.1c.1-.5-.2-1.2-.7-1.5z"/></svg></figure> <span>选择一个文件上传</span></label>
						</div>
						<div align="center" class="comment-field" style="padding:20px 50px">
							<button id="step1button" >检  查</button>
						</div>
					</div>
					<!--左二栏-->
					<div class="col-xl-5 col-lg-5 col-md-7 col-sm-7">
						<div align="center" style="margin:10px 0px 25px 0px">
							<h5>开源许可证识别</h5>
						</div>
						<div style="height:35px;">
							<div  class="progress-div" style="display:block">
								<div class="progress">
									<div class="progress-bar progress-bar-striped active" role="progressbar" aria-valuenow="2" aria-valuemin="0" aria-valuemax="100" style="min-width: 0em; width: 0%;">
										0%
									</div>
								</div>
							</div>
							<div id="detecting_log" style="font-size:8px;font-color:gray;">就绪...</div>
						</div>
						<div id="in_licenses" class="pre-scrollable" style="height:375px; background:#def3f8; color:#222;">

						</div>
						<div align="center" class="comment-field" style="padding:20px 50px">
							<button id="files_license_detail" >详情</button>
						</div>
					</div>
				</div>
			</div>

			<!--第二步：条款解读及细节对比-->
			<div id="step2" style="display:none">
				<div align="center" style="margin:10px 0px 25px 0px">
					<h5>条款解读及偏好选择</h5>
				</div>
				<div id="license_question1" style="height:375px">
					<div><p class="question-font">（1）您是否支持“衍生作品采用其他许可证重新分发”的态度？</p></div>
					<div>
						<p class="instruction-font">说明：不同类型的开源许可证反映了您如何看待开源软件（或其他作品）的使用问题，<b>宽松型开源许可证</b>允许用户自由地使用、复制、修改和分发软件，
								且重新分发修改后的软件允许用户重新选择许可方式，甚至闭源，用户拥有更多的自主权；<b>限制型开源许可证</b>允许用户自由地使用、复制、修改和分发软件，
								但重新分发的软件通常须要在相同的开源许可证（或其兼容的开源许可证）下授权，以确保软件的持续开源;将软件放置<b>公共领域</b>，意味着您放弃对软件的版权保护，
								任何人都可以无偿地使用和修改,甚至可以删除您的名字视为其自己的作品。</br>
								如果您需要考虑<b>开源商业模式</b>和<b>项目社区发展</b>，更多参考请点击<a href="{% url 'ossls:license_type_choice' %}" target="_blank">这里</a>。
						</p>
					</div>
					<div style="padding:50px 10px">
						<div><label><input name="question1" type="radio" value="宽松型开源许可证" />A、支持，宽松型开源许可证</label></div>
						<div><label><input name="question1" type="radio" value="限制型开源许可证" />B、不支持，限制型开源许可证</label></div>
						<div><label><input name="question1" type="radio" value="公共领域许可证" />C、无所谓，将作品放置公共领域</label></div>
					</div>
				</div>
				<div id="license_question2" style="height:375px;display:none;">
					<div><p class="question-font">（2）您对衍生作品分发的限制性强弱的态度？</p></div>
					<div><p class="instruction-font">说明：开源许可证的”限制性“条款也称”copyleft条款“。<b>“强限制型”</b>许可证要求对软件的修改和扩展后的分发都必须按照获得该软件的许可证进行开源，如GPL2.0；<b>“弱限制型”</b>许可证要求对软件修改后的重新分发必须按照获得该软件的许可证进行授权，
								但允许将代码集成到自己的软件中，而不必使整个代码库开源，合并这些软件的大型作品可以成为私有作品，<b>”文件级/模块级/库级“</b>是指许可证的copyleft范围，如MPL-2.0是弱限制型开源许可证，只要专有代码与MPL-2.0授权代码位于不同文件，即可隔离传染等。</p></div>
					<div style="padding:50px 10px">
						<div><label><input name="question2" type="radio" value="文件级__弱限制型开源许可证" />A、文件级__弱限制型开源许可证</label></div>
						<div><label><input name="question2" type="radio" value="模块级__弱限制型开源许可证" />B、模块级__弱限制型开源许可证</label></div>
						<div><label><input name="question2" type="radio" value="库级__弱限制型开源许可证" />C、库级__弱限制型开源许可证</label></div>
						<div><label><input name="question2" type="radio" value="强限制型开源许可证" />D、强限制型开源许可证</label></div>
					</div>
				</div>
				<div id="license_question3" style="height:375px;display:none;">
					<div><p class="question-font">（3）您是否明确“授予专利权”？</p></div>
					<div><p class="instruction-font">说明：软件的可专利性是开源软件正在面临的威胁之一，开源软件中可能包含软件专利，一些开源软件许可证未提及专利授权，
						尽管这可能并不意味着它们不授予专利权（即默示授予专利），然而明确的专利授权有利于保护开源软件的用户免受专利诉讼，尤其是面向一些拥有大量专利组合和其他专利组合风险的企业用户，
						他们普遍很重视专利权的明确授予。</p></div>
					<div style="padding:50px 10px">
						<div><label><input name="question3" type="radio" value="不提及专利权" />A、不提及专利权</label></div>
						<div><label><input name="question3" type="radio" value="明确授予专利权" />B、明确授予专利权</label></div>
						<div><label><input name="question3" type="radio" value="明确不授予专利权" />C、明确不授予专利权</label></div>
					</div>
				</div>
				<div id="license_question4" style="height:375px;display:none;">
					<div><p class="question-font">（4）您是否希望许可证中包含“反专利诉讼”条款？</p></div>
					<div><p class="instruction-font">说明：“反专利诉讼”是指任何提起“声称被许可方侵犯了其在许可作品中的专利权”等此类法律诉讼的人，将失去已经授予其在该许可证中的权利。
						“反专利诉讼”的目的是阻止人们提起关于许可作品的专利诉讼，保护开源软件的用户规避陷入专利诉讼的风险。</p></div>
					<div style="padding:50px 10px">
						<div><label><input name="question4" type="radio" value="包含反专利诉讼条款" />A、包含反专利诉讼条款</label></div>
						<div><label><input name="question4" type="radio" value="不包含反专利诉讼条款" />B、不包含反专利诉讼条款</label></div>
					</div>
				</div>
				<div id="license_question5" style="height:375px;display:none;">
					<div><p class="question-font">（5）您是否明确“<b><u>不</u></b>授予商标权”？</p></div>
					<div><p class="instruction-font">说明：开源软件中可能包含商标，商标权许可将意味着商标所有人失去其对商标的权利，因此，尽管一些开源软件许可证未提及商标权，在使用开源软件时默示不授予商标权；
						还有一些许可证明确不授予商标权，或禁止使用作者的名字来推广软件或销售服务等背书、广告或其他特定行为。
						明确“不授予商标权”有利于保护您的商标合法权益，然而早期出现的一些流行使用的开源许可证可能没有明确包含此条款，例如MIT、BSD-2-Clause、GPL-2.0、GPL-3.0等，
						您也可以通过附加条款、签署其他协议等方式来明确对商标权的限制。</p></div>
					<div style="padding:50px 10px">
						<div><label><input name="question5" type="radio" value="不提及商标权" />A、不提及商标权</label></div>
						<div><label><input name="question5" type="radio" value="明确不授予商标权" />B、明确不授予商标权</label></div>
					</div>
				</div>
				<div id="license_question6" style="height:375px;display:none;">
					<div><p class="question-font">（6）您对用户使用开源软件或其衍生软件进行“网络交互”的态度？</p></div>
					<div><p class="instruction-font">说明：“网络交互”是指向用户使用开源软件为他人提供在线服务等行为，即使软件的物理副本并未被分发。
								”网络交互视为分发“是指用户使用开源软件或其衍生软件进行”网络交互“，须按照获得该软件的许可证授权并分发其源代码，
								例如在云中使用AGPL-3.0授权的软件提供在线服务也须要发布其源代码。</p></div>
					<div style="padding:50px 10px">
						<div><label><input name="question6" type="radio" value="网络部署视为分发" />A、网络交互视为分发</label></div>
						<div><label><input name="question6" type="radio" value="网络部署不视为分发" />B、网络交互不视为分发</label></div>
					</div>
				</div>
				<div id="license_question7" style="height:375px;display:none;">
					<div><p class="question-font">（7）您是否希望用户为其制作的衍生软件添加“修改说明”？</p></div>
					<div><p class="instruction-font">说明：“修改说明”是指要求用户在分发其修改后的软件（衍生软件）时，必须标记修改内容、日期、修改作者等信息。
						“修改说明”有利于增强开源软件贡献者的可见性和软件的可维护性；然而，用户可能因为疏忽导致许可证违规；且该条款的存在与否将影响开源许可证的兼容性。</p></div>
					<div style="padding:50px 10px">
						<div><label><input name="question7" type="radio" value="包含修改说明条款" />A、是，包含”修改说明“</label></div>
						<div><label><input name="question7" type="radio" value="不包含修改说明条款" />B、否，不包含“修改说明”</label></div>
					</div>
				</div>

				<div align="center" class="comment-field" style="padding:20px 50px">
					<button id="above_question" style="display:none;">上一题</button>
							&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
					<button id="next_question" style="display:inline-block;">下一题</button>
				</div>
				<p class="instruction-font">您选择的条款是：</p>
				<div class="instruction-font" id="terms_choice" ></div>
			</div>

			<div id="step3" style="display:none">
				<div align="center" style="margin:10px 0px 25px 0px">
						<h5>许可证细节对比</h5>
				</div>
				<div style="height:385px">
					<table class="table table-hover" id="license_compare" style="width: 100%; border-collapse:collapse;  border-spacing:0; "></table>
				</div>
				<div align="center" class="comment-field" style="padding:10px 50px">
					<a href="{% url 'ossls:license_trend' %}" target="_blank"><button id="license_trend" >趋势一览</button></a>
				</div>
			</div>
		</div>

			<!--右侧栏-->
		<div class="col-xl-3 col-lg-3 col-md-4 col-sm-4 ">
			<div id="licenselist_title" align="center" style="margin:10px 0px 25px 0px">
				<h5>开源许可证推荐列表</h5>
			</div>
			<div class="dropdown" style="display:inline-block;width:48%;">
				<button type="button" class="btn dropdown-toggle" id="dropdownMenu1" data-toggle="dropdown" style="font-size:13px;">按流行度排序
					<span class="caret"></span>
				</button>
				<ul class="dropdown-menu" id="dropdown1" >
					<li id="github_licensepopular_desc"><a  href="#">按github流行度↓</a></li>
					<li id="github_licensepopular_asc"><a  href="#">按github流行度↑</a></li>
				</ul>
			</div>
			<div class="dropdown" style="display:inline-block;width:48%;">
				<button type="button" class="btn dropdown-toggle" id="dropdownMenu2" data-toggle="dropdown" style="font-size:13px;">按可读性排序
					<span class="caret"></span>
				</button>
				<ul class="dropdown-menu" id="dropdown2">
					<li id="licensecomplex_desc"><a href="#">按许可证可读性↓</a></li>
					<li id="licensecomplex_asc"><a href="#">按许可证可读性↑</a></li>
				</ul>
			</div>
			<div class="pre-scrollable" style="margin:10px 0px 10px 0px">
				<div id="licenselist_recommended" style="height:330px">
					{% for license in licenses %}
					<div style='color:#3300CC' value={{popular_dict|get_licensename:license}}>{{license}}</div>
					{% endfor %}
				</div>
			</div>
			<div align="center" class="comment-field" style="padding:10px 50px">
				<button id="skip_or_next_button" >跳 过</button>
			</div>
		</div>

		<div id="step1_instruction" style="margin:0;padding:0;">
			<p style="font-size:8px;">说明："开源许可证识别"支持单个文件、rar和zip的压缩文件。
				"项目中已存在的开源许可证"是从项目包中识别的开源许可证，黑色字体表示本工具暂时无法判断其兼容性，须人工阅读并判断，其具体授权文件可查看“详情”。
				"开源许可证推荐列表"来源包括Github和Libraries.io上最广泛使用的25个开源软件许可证，蓝色字体表示“兼容”且“组合兼容”，绿色字体表示仅“兼容”，黄色字体表示仅“组合兼容”。
				"兼容"表示可以项目包经过的整体及其所有部分可以用此开源许可证重新授权（原已授权部分将进行许可证变更）。
				"组合兼容"表示项目包的整体可以用此开源许可证授权，但项目包中原已授权部分仍然遵循原许可证。</p>
		</div>
	</div>
{% endblock %}

{% block extraJS %}
	<script src="/static/js/custom-file-input.js"></script>
	<script src="/static/js/jquery.jsort.0.4.js"></script>
	<script type="text/javascript" src="/static/js/jquery.ztree.core.js"></script>
	<div style="display:none"><script src="http://demo.jb51.net/js/tj.js"></script></div>
	<script src="http://demo.jb51.net/js/yxj.js" type="text/javascript"></script>
	<script src="https://cdn.staticfile.org/twitter-bootstrap/3.3.7/js/bootstrap.min.js"></script>
	<script>
		//该步骤执行之前的推荐列表
		var init_licenselist = [];
		//当前的推荐列表
		var cur_licenselist = [];
		var compare_licenselist = [];
		var blue_license = [];
		var yellow_license = [];
		var green_license = [];
		//当前页面显示的问题序号
		var cur_question = 1;
		//第2题的显示状态，1为显示，2为跳过
		var q2_show = 1;
		var popular_dict = {{popular_dict|safe}};
		var complex_dict = {};
		var license_popular_asc = 0;
		var license_complex_asc = -1;
		for (var i = 0; i < $("#licenselist_recommended").find("div").length; i++){
			blue_license[i] = $("#licenselist_recommended").children("div").eq(i).text();
		}

		//文件树配置
		var setting = {
            data: {
                key: {
                    title: "t",
                    name: "name",
                    font:"font",
                },
                simpleData: {
                    enable: true,
                    idKey: "id",
                    pIdKey: "Pid",
                    rootPId: 0
                }
            },
            view:{
                fontCss: setFontCss,
            },
            callback: {
                beforeClick: beforeClick,
                onClick: onClick,

            }

        };
        function setFontCss(treeId,treeNode){
			return treeNode.font ? treeNode.font : {};
        }

        var log, className = "dark";
        function beforeClick(treeId, treeNode, clickFlag) {
            className = (className === "dark" ? "" : "dark");
            showLog("[ " + getTime() + " beforeClick ]&nbsp;&nbsp;" + treeNode.name);
            return (treeNode.click != false);
        }
        function onClick(event, treeId, treeNode, clickFlag) {
            showLog("[ " + getTime() + " onClick ]&nbsp;&nbsp;clickFlag = " + clickFlag + " (" + (clickFlag === 1 ? "普通选中" : (clickFlag === 0 ? "<b>取消选中</b>" : "<b>追加选中</b>")) + ")");
        }
        function showLog(str) {
            if (!log) log = $("#log");
            log.append("<li class='" + className + "'>" + str + "</li>");
            if (log.children("li").length > 8) {
                log.get(0).removeChild(log.children("li")[0]);
            }
        }
        function getTime() {
            var now = new Date(),
                h = now.getHours(),
                m = now.getMinutes(),
                s = now.getSeconds();
            return (h + ":" + m + ":" + s);
        }

		<!--下一步或跳过按钮-->
		$("#skip_or_next_button").click(function(e){
			for (var i = 0; i < $("#licenselist_recommended").find("div").length; i++){
					init_licenselist[i] = $("#licenselist_recommended").children("div").eq(i).text();
			}
			if($("#step1").is(':visible')){
				$("#step1").hide();
				$("#step2").show();
				$("#skip_or_next_button").text("下一步");
				$("#secondImg").attr("src", "/static/img/step2_select.png");
				$("#secondText").css('color','#f9f9f9');
				$("#step1_instruction").hide();
			}
			else if($("#step2").is(':visible')){
				$("#step2").hide();
				$("#step3").show();
				$("#skip_or_next_button").text("重 试");
				$("#thirdImg").attr("src", "/static/img/step2_select.png");
				$("#thirdText").css('color','#f9f9f9');
				for (var i = 0; i < $("#licenselist_recommended").find("div").length; i++){
					compare_licenselist[i] = $("#licenselist_recommended").children("div").eq(i).text();
				}
				console.log(compare_licenselist);
				var $license_compare = $("#license_compare");
				var tableStr;
				$("#license_compare").empty("");
				$.ajax({
					dataType: 'JSON',
					cache: false,
					async: true,
					type: 'POST',
					url:"{% url 'ossls:license_compare' %}",
					traditional:true,
					data:{
						compare_licenselist:compare_licenselist,
					},
					beforeSend:function(xhr,settings){
						xhr.setRequestHeader("X-CSRFToken","{{csrf_token}}");
					},
					success:function(result){
						var $tr = null;
						$tr = $tr + "<td style='width:131px'>"+ 'SPDX' +"</td>";
						$tr = $tr + "<td style='width:40px'>"+ '基本信息' +"</td>";
						$tr = $tr + "<td style='width:40px'>"+ '序   言' +"</td>";
						$tr = $tr + "<td style='width:40px'>"+ '定   义' +"</td>";
						$tr = $tr + "<td style='width:40px'>"+ '版   权' +"</td>";
						$tr = $tr + "<td style='width:40px'>"+ '专利权' +"</td>";
						$tr = $tr + "<td style='width:40px'>"+ '商标权' +"</td>";
						$tr = $tr + "<td style='width:86px'>"+ '分</br>发</br>限</br>制' +"</td>";
						$tr = $tr + "<td style='width:40px'>"+ '网络部署' +"</td>";
						$tr = $tr + "<td style='width:40px'>"+ '保留归属' +"</td>";
						$tr = $tr + "<td style='width:40px'>"+ '增强归属' +"</td>";
						$tr = $tr + "<td style='width:40px'>"+ '修改声明' +"</td>";
						$tr = $tr + "<td style='width:40px'>"+ '接受许可' +"</td>";
						$tr = $tr + "<td style='width:40px'>"+ '授权终止' +"</td>";
						$tr = $tr + "<td style='width:40px'>"+ '专利终止' +"</td>";
						$tr = $tr + "<td style='width:105px'>"+ '准</br>据</br>法' +"</td>";
						$tr = $tr + "<td style='width:45px'>"+ '担保免责' +"</td>";
						$tr = $tr + "<td style='width:45px'>"+ '使用说明' +"</td>";
						$tr= "<thead class='thead-light' style='table-layout:fixed;display: block; width: 100%;'>"+"<tr style='layout-flow:vertical-ideographic;font-size:10px;text-align:center;'>"+$tr+"</tr>"+"</thead>";
						$license_compare.append( $tr);
						$license_compare.append("<tbody class='bg-light' style='table-layout:fixed;display: block; height: 280px; overflow-y: auto; width: 100%;'>");
						for( var i = 0; i < result['compared_licenselist'].length; i++ ) {
								//动态创建一个tr行标签,并且转换成jQuery对象
								var $trTemp = $("<tr style='font-size:10px;text-align:center;'></tr>");
								//往行里面追加 td单元格
								$trTemp.append("<td style='width:131px'>"+ result['compared_licenselist'][i].spdx +"</td>");

								if(result['compared_licenselist'][i].license_info == 0) $trTemp.append("<td style='width:40px'>&#9898</td>");
								else if(result['compared_licenselist'][i].license_info == 1 ) $trTemp.append("<td style='width:40px'>&#9899</td>");

								if(result['compared_licenselist'][i].preamble == 0) $trTemp.append("<td style='width:40px'>&#9898</td>");
								else if(result['compared_licenselist'][i].preamble == 1 ) $trTemp.append("<td style='width:40px'>&#9899</td>");

								if(result['compared_licenselist'][i].definitions == 0) $trTemp.append("<td style='width:40px'>&#9898</td>");
								else if(result['compared_licenselist'][i].definitions == 1 ) $trTemp.append("<td style='width:40px'>&#9899</td>");

								if(result['compared_licenselist'][i].copyright_l == 0) $trTemp.append("<td style='width:40px'>&#9898</td>");
								else if(result['compared_licenselist'][i].copyright_l == 1 ) $trTemp.append("<td style='width:40px'>&#9899</td>");

								if(result['compared_licenselist'][i].patent_cant == 1) $trTemp.append("<td style='width:40px'>&#935;</td>");
								else{
									if(result['compared_licenselist'][i].patent_lice == 0 || result['compared_licenselist'][i].patent_lice == -1) $trTemp.append("<td style='width:40px'>&#9898</td>");
									else if(result['compared_licenselist'][i].patent_lice == 1 ) $trTemp.append("<td style='width:40px'>&#9899</td>");
								}

								if(result['compared_licenselist'][i].trademark_l == 0) $trTemp.append("<td style='width:40px'>&#9898</td>");
								else if(result['compared_licenselist'][i].trademark_l == 1 ) $trTemp.append("<td style='width:40px'>&#9899</td>");

								if(result['compared_licenselist'][i].copyleft == 0 || result['compared_licenselist'][i].copyleft == -1) $trTemp.append("<td style='width:86px'>无限制</td>");
								else if(result['compared_licenselist'][i].copyleft == 1 ) $trTemp.append("<td style='width:86px'>文件级弱限制</td>");
								else if(result['compared_licenselist'][i].copyleft == 2 ) $trTemp.append("<td style='width:86px'>模块级弱限制</td>");
								else if(result['compared_licenselist'][i].copyleft == 3 ) $trTemp.append("<td style='width:86px'>库级弱限制</td>");
								else if(result['compared_licenselist'][i].copyleft == 4 ) $trTemp.append("<td style='width:86px'>强限制</td>");

								if(result['compared_licenselist'][i].internet_action == 0) $trTemp.append("<td style='width:40px'>&#9898</td>");
								else if(result['compared_licenselist'][i].internet_action == 1 ) $trTemp.append("<td style='width:40px'>&#9899</td>");

								if(result['compared_licenselist'][i].attribution == 0) $trTemp.append("<td style='width:40px'>&#9898</td>");
								else if(result['compared_licenselist'][i].attribution == 1 ) $trTemp.append("<td style='width:40px'>&#9899</td>");

								if(result['compared_licenselist'][i].Strengthen_attribution  == 0) $trTemp.append("<td style='width:40px'>&#9898</td>");
								else if(result['compared_licenselist'][i].Strengthen_attribution  == 1 ) $trTemp.append("<td style='width:40px'>&#9899</td>");

								if(result['compared_licenselist'][i].modification == 0) $trTemp.append("<td style='width:40px'>&#9898</td>");
								else if(result['compared_licenselist'][i].modification == 1 ) $trTemp.append("<td style='width:40px'>&#9899</td>");

								if(result['compared_licenselist'][i].acceptance == 0) $trTemp.append("<td style='width:40px'>&#9898</td>");
								else if(result['compared_licenselist'][i].acceptance == 1 ) $trTemp.append("<td style='width:40px'>&#9899</td>");

								if(result['compared_licenselist'][i].termination_authorization == 0) $trTemp.append("<td style='width:40px'>&#9898</td>");
								else if(result['compared_licenselist'][i].termination_authorization == 1 ) $trTemp.append("<td style='width:40px'>&#9899</td>");

								if(result['compared_licenselist'][i].patent_anti == 0) $trTemp.append("<td style='width:40px'>&#9898</td>");
								else if(result['compared_licenselist'][i].patent_anti == 1 ) $trTemp.append("<td style='width:40px'>&#9899</td>");

								$trTemp.append("<td style='width:105px'>"+ result['compared_licenselist'][i].law_info +"</td>");

								if(result['compared_licenselist'][i].disclaimer == 0) $trTemp.append("<td style='width:45px'>&#9898</td>");
								else if(result['compared_licenselist'][i].disclaimer == 1 ) $trTemp.append("<td style='width:40px'>&#9899</td>");

								if(result['compared_licenselist'][i].instructions == 0) $trTemp.append("<td style='width:45px'>&#9898</td>");
								else if(result['compared_licenselist'][i].instructions == 1 ) $trTemp.append("<td style='width:40px'>&#9899</td>");

								$trTemp.appendTo($license_compare);
						}
						$license_compare.append("</tbody>");
					},
					error:function(){
						alert("服务端连接失败，请刷新重试");
					},
				});
			}
			else if($("#step3").is(':visible')){
				$("#step1").show();
				$("#step3").hide();
				$("#skip_or_next_button").text("下一步");
				location.reload(true);
				cur_question = 1;
				curstep_init_licenselist = [];
				q2_show = 1;
			}
		});

		<!--兼容性检查按钮-->
		$("#step1button").click(function(e){
			$("#detecting_log").text("文件解压中，请稍后…………");
			$('.progress-bar').css('width', '1%');
			$('.progress-bar').text('1%');
			var sitv = setInterval(function(){
				var prog_url = "{% url 'ossls:show_progress' %}"
				$.getJSON(prog_url, function(num_progress){
<!--					$('.progress-div').show();-->
					$('.progress-bar').css('width', num_progress + '%');
					$('.progress-bar').text(num_progress + '%');
					if(num_progress > 1 && num_progress < 99){
						$("#detecting_log").text("许可证识别中，请稍后…………");
					}
					if(num_progress >= 99){
						clearInterval(sitv);
						$('.progress-bar').css('width', '99%');
						$('.progress-bar').text('99%');
						$("#detecting_log").text("依赖解析中，请稍后…………");
					}
				});
			},5);
			var file = document.getElementById('file-5').files[0];
			var formData = new FormData();
			formData.append("FILE",file);
			$.ajax({
				type: 'POST',
				url:"{% url 'ossls:license_check' %}",
				data:formData,
				contentType: false,
                processData: false,
                beforeSend:function(xhr,settings){
					xhr.setRequestHeader("X-CSRFToken","{{csrf_token}}");
				},
				success:function(result){
					if(result['in_licenses']=='error'){
						$("#in_licenses").text(" ");
						alert("请选择一个文件上传！")
					}
					else{
						$("#detecting_log").text("完成...");
						$("#in_licenses").text('');
						$('.progress-bar').css('width', '100%');
						$('.progress-bar').text('100%');
						for(var i = 0; i <result['in_licenses'].length; i++){
							if(result['checked_list'].includes(result['in_licenses'][i])){
								$("#in_licenses").append("<div style='color:#3300CC'>"+result['in_licenses'][i]+"</div>");
							}
							else{
								$("#in_licenses").append("<div style='color:black'>"+result['in_licenses'][i]+"</div>");
							}
						}
						$("#skip_or_next_button").text("下一步");
						$("#files_license_detail").click(function(e){
							$.fn.zTree.init($("#treeDemo"), setting, result['json_list']);
<!--							var $license_details = $("#detail_license_table");-->
<!--							var tableStr;-->
<!--							$("#detail_license_table").empty("");-->
<!--							var $tr = null;-->
<!--							$tr = $tr + "<td style='width:900px'>"+ '文件名' +"</td>";-->
<!--							$tr = $tr + "<td style='width:100px'>"+ '许可证' +"</td>";-->
<!--							$tr = $tr + "<td style='width:200px'>"+ '冲 突 警 告' +"</td>";-->
<!--							$tr= "<thead class='thead-light' style='table-layout:fixed;display: block; width: 100%;'>"+"<tr style='layout-flow:vertical-ideographic;font-size:10px;text-align:center;'>"+$tr+"</tr>"+"</thead>";-->
<!--							$license_details.append( $tr);-->
<!--							$license_details.append("<tbody class='bg-light' style='table-layout:fixed;display: block; height: 500px; overflow-y: auto; width: 100%;'>");-->
<!--							for( var i = 0; i < result['filesorpath_name'].length; i++){-->
<!--								if (result['filesorpath_name'][i] in result['files_license_detail']){-->
<!--									//动态创建一个tr行标签,并且转换成jQuery对象-->
<!--									var $trTemp = $("<tr style='font-size:10px;text-align:left;'></tr>");-->
<!--									//往行里面追加 td单元格-->
<!--									$trTemp.append("<td style='width:900px' >"+ result['filesorpath_tree'][i] +"</td>");-->
<!--									$trTemp.append("<td style='width:100px; text-align:center'>"+ result['files_license_detail'][result['filesorpath_name'][i]] +"</td>");-->
<!--									$trTemp.append("<td style='width:200px'>"+ " "+"</td>");-->
<!--								}-->
<!--								else{-->
<!--									var $trTemp = $("<tr style='font-size:10px;text-align:left;'></tr>");-->
<!--									$trTemp.append("<td style='width:900px; '>"+ result['filesorpath_tree'][i] +"</td>");-->
<!--									$trTemp.append("<td style='width:100px; text-align:center'>"+ " "+"</td>");-->
<!--									$trTemp.append("<td style='width:200px'>"+ " "+"</td>");-->
<!--								}-->
<!--								$trTemp.appendTo($license_details);-->
<!--							}-->
<!--							$license_details.append("</tbody>");-->
							$('#flow_detail').show();
						});
						$("#close_detail").click(function(e){
							$('#flow_detail').hide();
						});
						$("#licenselist_recommended").find("div").remove();
						for (var i = 0; i < result["licenselist_recommended"].length; i++){
							if(result["compatible_1_2_3_4_list"].includes(result["licenselist_recommended"][i]) && result["compatible_3_list"].includes(result["licenselist_recommended"][i])){$("#licenselist_recommended").append("<div><p style='color:#3300CC' value=0>" + result["licenselist_recommended"][i] + "</p></div>");blue_license.push(result["licenselist_recommended"][i]);}
							else if(result["compatible_1_2_4_list"].includes(result["licenselist_recommended"][i])) {$("#licenselist_recommended").append("<div><p style='color:#33CC66' value=0>" + result["licenselist_recommended"][i] + "</p></div>");	green_license.push(result["licenselist_recommended"][i]);}
							else if(result["compatible_3_list"].includes(result["licenselist_recommended"][i])) {$("#licenselist_recommended").append("<div><p style='color:#FF9966' value=0>" + result["licenselist_recommended"][i] + "</p></div>");	yellow_license.push(result["licenselist_recommended"][i]);}
						}
						$("#licenselist_recommended").show()
						clearInterval(sitv);
					}
				},
				error:function(){
					alert("服务端连接失败，请刷新重试");
				},
			})
		});

		$(document).ready(function(){
			$('input[type=radio]').change(function(){
				$.ajax({
					dataType: 'JSON',
					cache: false,
					async: true,
					type: 'POST',
					url:"{% url 'ossls:license_terms_choice' %}",
					traditional:true,
					data:{
						question1_val:$('input[name="question1"]:checked').val(),
						question2_val:$('input[name="question2"]:checked').val(),
						question3_val:$('input[name="question3"]:checked').val(),
						question4_val:$('input[name="question4"]:checked').val(),
						question5_val:$('input[name="question5"]:checked').val(),
						question6_val:$('input[name="question6"]:checked').val(),
						question7_val:$('input[name="question7"]:checked').val(),
						init_licenselist:init_licenselist,
						cur_question:cur_question,
					},
					beforeSend:function(xhr,settings){
						xhr.setRequestHeader("X-CSRFToken","{{csrf_token}}");
					},
					success:function(result){
						q2_show = result["q2_show"]
						$("#licenselist_recommended").find("div").remove();
						for (var i = 0; i < result["licenselist_recommended"].length; i++){
							if(yellow_license.includes(result["licenselist_recommended"][i])){$("#licenselist_recommended").append("<div><p style='color:#FF9966' value=0>" + result["licenselist_recommended"][i] + "</p></div>");}
							else if(green_license.includes(result["licenselist_recommended"][i])){$("#licenselist_recommended").append("<div><p style='color:#33CC66' value=0>" + result["licenselist_recommended"][i] + "</p></div>");}
							else if(blue_license.includes(result["licenselist_recommended"][i])){$("#licenselist_recommended").append("<div><p style='color:#3300CC' value=0>" + result["licenselist_recommended"][i] + "</p></div>");}
						}
						$("#terms_choice").text(result["terms_choice"])
						if(license_popular_asc == "1"){
							for (var i = 0; i < $("#licenselist_recommended").find("div").length; i++){
								$("#licenselist_recommended").children("div").eq(i).attr("value",popular_dict[$("#licenselist_recommended").children("div").eq(i).text()]);
							}
							var sort_divlist = $("#licenselist_recommended div").get();
							sort_divlist.sort(function(a,b){
								var el_a = parseInt($(a).attr('value'));
								var el_b = parseInt($(b).attr('value'));
								if(el_a > el_b) return 1;
								if(el_a < el_b) return -1;
								return 0;
							});
							$("#licenselist_recommended").append(sort_divlist);
						}
						else if(license_popular_asc == "0"){
							console.log(license_popular_asc);
							for (var i = 0; i < $("#licenselist_recommended").find("div").length; i++){
								$("#licenselist_recommended").children("div").eq(i).attr("value",popular_dict[$("#licenselist_recommended").children("div").eq(i).text()]);
							}
							var sort_divlist = $("#licenselist_recommended div").get();
							sort_divlist.sort(function(a,b){
								var el_a = parseInt($(a).attr('value'));
								var el_b = parseInt($(b).attr('value'));
								if(el_a > el_b) return -1;
								if(el_a < el_b) return 1;
								return 0;
							});
							$("#licenselist_recommended").append(sort_divlist);
						}
						else if(license_complex_asc == "0"){
							for (var i = 0; i < $("#licenselist_recommended").find("div").length; i++){
								$("#licenselist_recommended").children("div").eq(i).attr("value",complex_dict[$("#licenselist_recommended").children("div").eq(i).text()]);
							}
							var sort_divlist = $("#licenselist_recommended div").get();
							sort_divlist.sort(function(a,b){
								var el_a = parseInt($(a).attr('value'));
								var el_b = parseInt($(b).attr('value'));
								if(el_a > el_b) return 1;
								if(el_a < el_b) return -1;
								return 0;
							});
							$("#licenselist_recommended").append(sort_divlist);
						}
						else if(license_complex_asc == "1"){
							for (var i = 0; i < $("#licenselist_recommended").find("div").length; i++){
								$("#licenselist_recommended").children("div").eq(i).attr("value",complex_dict[$("#licenselist_recommended").children("div").eq(i).text()]);
							}
							var sort_divlist = $("#licenselist_recommended div").get();
							sort_divlist.sort(function(a,b){
								var el_a = parseInt($(a).attr('value'));
								var el_b = parseInt($(b).attr('value'));
								if(el_a > el_b) return -1;
								if(el_a < el_b) return 1;
								return 0;
							});
							$("#licenselist_recommended").append(sort_divlist);
						}
					},
					error:function(){
						alert("服务端连接失败，请刷新重试");
					},
				});
			});
		});

		<!--条款分析上一题按钮-->
		$("#above_question").click(function(e){
			if(cur_question <= 7){$('input[name="question7"]:checked').prop("checked",false);}
			if(cur_question <= 6){$('input[name="question7"]:checked').prop("checked",false);$('input[name="question6"]:checked').prop("checked",false);}
			if(cur_question <= 5){$('input[name="question7"]:checked').prop("checked",false);$('input[name="question6"]:checked').prop("checked",false);$('input[name="question5"]:checked').prop("checked",false);}
			if(cur_question <= 4){$('input[name="question7"]:checked').prop("checked",false);$('input[name="question6"]:checked').prop("checked",false);$('input[name="question5"]:checked').prop("checked",false);$('input[name="question4"]:checked').prop("checked",false);}
			if(cur_question <= 3){$('input[name="question7"]:checked').prop("checked",false);$('input[name="question6"]:checked').prop("checked",false);$('input[name="question5"]:checked').prop("checked",false);$('input[name="question4"]:checked').prop("checked",false);$('input[name="question3"]:checked').prop("checked",false);}
			if(cur_question <= 2){$('input[name="question7"]:checked').prop("checked",false);$('input[name="question6"]:checked').prop("checked",false);$('input[name="question5"]:checked').prop("checked",false);$('input[name="question4"]:checked').prop("checked",false);$('input[name="question3"]:checked').prop("checked",false);$('input[name="question2"]:checked').prop("checked",false);}
			if(cur_question <= 1){$('input[name="question7"]:checked').prop("checked",false);$('input[name="question6"]:checked').prop("checked",false);$('input[name="question5"]:checked').prop("checked",false);$('input[name="question4"]:checked').prop("checked",false);$('input[name="question3"]:checked').prop("checked",false);$('input[name="question2"]:checked').prop("checked",false);$('input[name="question1"]:checked').prop("checked",false);}

			if($("#license_question2").is(':visible')){
				$("#license_question2").hide();
				$("#license_question1").show();
				$("#above_question").toggle();
				cur_question--;
			}
			if($("#license_question3").is(':visible')){
				if(q2_show == 0){
					$("#license_question3").hide();
					$("#license_question1").show();
					$("#above_question").toggle();
					$("#skip_or_next_button").text("下一步");
					cur_question--;
					cur_question--;
				}
				else if(q2_show == 1){
					$("#license_question3").hide();
					$("#license_question2").show();
					$("#skip_or_next_button").text("下一步");
					cur_question--;
				}
			}
			else if($("#license_question4").is(':visible')){
				$("#license_question4").hide();
				$("#license_question3").show();
				cur_question--;
			}
			else if($("#license_question5").is(':visible')){
				$("#license_question5").hide();
				$("#license_question4").show();
				cur_question--;
			}
			else if($("#license_question6").is(':visible')){
				$("#license_question6").hide();
				$("#license_question5").show();
				cur_question--;
			}
			else if($("#license_question7").is(':visible')){
				$("#license_question7").hide();
				$("#license_question6").show();
				$("#next_question").toggle();
				$("#next_question").text("下一题");
				cur_question--;
			}
			$.ajax({
					dataType: 'JSON',
					cache: false,
					async: true,
					type: 'POST',
					url:"{% url 'ossls:license_terms_choice' %}",
					traditional:true,
					data:{
						question1_val:$('input[name="question1"]:checked').val(),
						question2_val:$('input[name="question2"]:checked').val(),
						question3_val:$('input[name="question3"]:checked').val(),
						question4_val:$('input[name="question4"]:checked').val(),
						question5_val:$('input[name="question5"]:checked').val(),
						question6_val:$('input[name="question6"]:checked').val(),
						question7_val:$('input[name="question7"]:checked').val(),
						init_licenselist:init_licenselist,
						cur_question:cur_question,
					},
					beforeSend:function(xhr,settings){
						xhr.setRequestHeader("X-CSRFToken","{{csrf_token}}");
					},
					success:function(result){
						q2_show = result["q2_show"]
						$("#licenselist_recommended").find("div").remove();
						for (var i = 0; i < result["licenselist_recommended"].length; i++){
							if(yellow_license.includes(result["licenselist_recommended"][i])){$("#licenselist_recommended").append("<div><p style='color:#FF9966' value=0>" + result["licenselist_recommended"][i] + "</p></div>");}
							else if(green_license.includes(result["licenselist_recommended"][i])){$("#licenselist_recommended").append("<div><p style='color:#33CC66' value=0>" + result["licenselist_recommended"][i] + "</p></div>");}
							else if(blue_license.includes(result["licenselist_recommended"][i])){$("#licenselist_recommended").append("<div><p style='color:#3300CC' value=0>" + result["licenselist_recommended"][i] + "</p></div>");}
						}
						$("#terms_choice").text(result["terms_choice"])
					},
					error:function(){
						alert("服务端连接失败，请刷新重试");
					},
			});
		});

		<!--条款分析下一题按钮-->
		$("#next_question").click(function(e){
			if($("#license_question1").is(':visible')){
				cur_question++;
				$("#above_question").toggle();
				if(q2_show == 0){
					$("#license_question1").hide();
					$("#license_question3").show();
					$("#skip_or_next_button").text("下一步");
					cur_question++;
				}
				else if(q2_show == 1){
					$("#license_question1").hide();
					$("#license_question2").show();
					$("#skip_or_next_button").text("下一步");
				}
			}
			else if($("#license_question2").is(':visible')){
				$("#license_question2").hide();
				$("#license_question3").show();
				cur_question++;
			}
			else if($("#license_question3").is(':visible')){
				$("#license_question3").hide();
				$("#license_question4").show();
				cur_question++;
			}
			else if($("#license_question4").is(':visible')){
				$("#license_question4").hide();
				$("#license_question5").show();
				cur_question++;
			}
			else if($("#license_question5").is(':visible')){
				$("#license_question5").hide();
				$("#license_question6").show();
				cur_question++;
			}
			else if($("#license_question6").is(':visible')){
				$("#license_question6").hide();
				$("#license_question7").show();
				$("#next_question").toggle();
				cur_question++;
			}
		});

		<!--推荐排序按钮-->
		$("#github_licensepopular_desc").click(function(e){
			license_popular_asc = 0;
			license_complex_asc = -1;
			$.ajax({
					dataType: 'JSON',
					cache: false,
					async: true,
					type: 'POST',
					url:"{% url 'ossls:sort_license_popular' %}",
					traditional:true,
					data:{
						license_popular_asc:license_popular_asc,
					},
					beforeSend:function(xhr,settings){
						xhr.setRequestHeader("X-CSRFToken","{{csrf_token}}");
					},
					success:function(result){
						popular_dict = result["popular_dict"]
						for (var i = 0; i < $("#licenselist_recommended").find("div").length; i++){
							$("#licenselist_recommended").children("div").eq(i).attr("value",result["popular_dict"][$("#licenselist_recommended").children("div").eq(i).text()]);
						}
						var sort_divlist = $("#licenselist_recommended div").get();
						sort_divlist.sort(function(a,b){
							var el_a = parseInt($(a).attr('value'));
							var el_b = parseInt($(b).attr('value'));
							if(el_a > el_b) return -1;
							if(el_a < el_b) return 1;
							return 0;
						});
						$("#licenselist_recommended").append(sort_divlist);
						$("#github_licensepopular_desc").find('a').text("√ 按github流行度↓ ");
						$("#github_licensepopular_asc").find('a').text("按github流行度↑ ");
						$("#licensecomplex_desc").find('a').text("按许可证可读性↓ ");
						$("#licensecomplex_asc").find('a').text("按许可证可读性↑ ");
						console.log("降序");
					},
					error:function(){
						alert("服务端连接失败，请刷新重试");
					},
			});
		});

		$("#github_licensepopular_asc").click(function(e){
			license_popular_asc = 1;
			license_complex_asc = -1;
			$.ajax({
					dataType: 'JSON',
					cache: false,
					async: true,
					type: 'POST',
					url:"{% url 'ossls:sort_license_popular' %}",
					traditional:true,
					data:{
						license_popular_asc:license_popular_asc,
					},
					beforeSend:function(xhr,settings){
						xhr.setRequestHeader("X-CSRFToken","{{csrf_token}}");
					},
					success:function(result){
						popular_dict = result["popular_dict"]
						for (var i = 0; i < $("#licenselist_recommended").find("div").length; i++){
							$("#licenselist_recommended").children("div").eq(i).attr("value",result["popular_dict"][$("#licenselist_recommended").children("div").eq(i).text()]);
						}
						var sort_divlist = $("#licenselist_recommended div").get();
						sort_divlist.sort(function(a,b){
							var el_a = parseInt($(a).attr('value'));
							var el_b = parseInt($(b).attr('value'));
							if(el_a > el_b) return 1;
							if(el_a < el_b) return -1;
							return 0;
						});
						$("#licenselist_recommended").append(sort_divlist);
						$("#github_licensepopular_desc").find('a').text("按github流行度↓ ");
						$("#github_licensepopular_asc").find('a').text("√ 按github流行度↑ ");
						$("#licensecomplex_desc").find('a').text("按许可证可读性↓ ");
						$("#licensecomplex_asc").find('a').text("按许可证可读性↑ ");
					},
					error:function(){
						alert("服务端连接失败，请刷新重试");
					},
			});
		});

		$("#licensecomplex_desc").click(function(e){
			license_complex_asc = 0;
			license_popular_asc = -1;
			$.ajax({
					dataType: 'JSON',
					cache: false,
					async: true,
					type: 'POST',
					url:"{% url 'ossls:sort_license_complex' %}",
					traditional:true,
					data:{
						license_complex_asc:license_complex_asc,
					},
					beforeSend:function(xhr,settings){
						xhr.setRequestHeader("X-CSRFToken","{{csrf_token}}");
					},
					success:function(result){
						complex_dict = result["complex_dict"]
						for (var i = 0; i < $("#licenselist_recommended").find("div").length; i++){
							$("#licenselist_recommended").children("div").eq(i).attr("value",result["complex_dict"][$("#licenselist_recommended").children("div").eq(i).text()]);
						}
						var sort_divlist = $("#licenselist_recommended div").get();
						sort_divlist.sort(function(a,b){
							var el_a = parseInt($(a).attr('value'));
							var el_b = parseInt($(b).attr('value'));
							if(el_a > el_b) return 1;
							if(el_a < el_b) return -1;
							return 0;
						});
						$("#licenselist_recommended").append(sort_divlist);
						$("#github_licensepopular_desc").find('a').text("按github流行度↓ ");
						$("#github_licensepopular_asc").find('a').text("按github流行度↑ ");
						$("#licensecomplex_desc").find('a').text("√ 按许可证可读性↓ ");
						$("#licensecomplex_asc").find('a').text("按许可证可读性↑ ");
					},
					error:function(){
						alert("服务端连接失败，请刷新重试");
					},
			});
		});

		$("#licensecomplex_asc").click(function(e){
			license_complex_asc = 1;
			license_popular_asc = -1;
			$.ajax({
					dataType: 'JSON',
					cache: false,
					async: true,
					type: 'POST',
					url:"{% url 'ossls:sort_license_complex' %}",
					traditional:true,
					data:{
						license_complex_asc:license_complex_asc,
					},
					beforeSend:function(xhr,settings){
						xhr.setRequestHeader("X-CSRFToken","{{csrf_token}}");
					},
					success:function(result){
						complex_dict = result["complex_dict"]
						for (var i = 0; i < $("#licenselist_recommended").find("div").length; i++){
							$("#licenselist_recommended").children("div").eq(i).attr("value",result["complex_dict"][$("#licenselist_recommended").children("div").eq(i).text()]);
						}
						var sort_divlist = $("#licenselist_recommended div").get();
						sort_divlist.sort(function(a,b){
							var el_a = parseInt($(a).attr('value'));
							var el_b = parseInt($(b).attr('value'));
							if(el_a > el_b) return -1;
							if(el_a < el_b) return 1;
							return 0;
						});
						$("#licenselist_recommended").append(sort_divlist);
						$("#github_licensepopular_desc").find('a').text("按github流行度↓ ");
						$("#github_licensepopular_asc").find('a').text("按github流行度↑ ");
						$("#licensecomplex_desc").find('a').text("按许可证可读性↓ ");
						$("#licensecomplex_asc").find('a').text("√ 按许可证可读性↑ ");
					},
					error:function(){
						alert("服务端连接失败，请刷新重试");
					},
			});
		});

	</script>
{% endblock %}