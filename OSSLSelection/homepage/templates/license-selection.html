{% extends 'ossls_base.html' %}

{% block extraCSS %}
	<!--文件上传CSS-->
	<link rel="stylesheet" type="text/css" href="/static/css/component.css" />
	<!--文件树CSS-->
	<link rel="stylesheet" href="/static/css/zTreeStyle/zTreeStyle.css">
	<!--选择列表CSS-->
	<link rel="stylesheet" href="/static/css/bootstrap-select.css">
	<!--标签CSS-->
	<link rel="stylesheet" href="/static/css/tab.css">
	<!--Bootstrap CSS-->
	<link rel="stylesheet" href="http://www.jq22.com/jquery/bootstrap-3.3.4.css">

	<!--[if IE]>
	<script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
	<![endif]-->
	<script>(function(e,t,n){var r=e.querySelectorAll("html")[0];r.className=r.className.replace(/(^|\s)no-js(\s|$)/,"$1js$2")})(document,window,0);</script>
{% endblock %}



{% block beforebody %}
	<!--流程图标-->
	<div style="margin:60px 0px 40px 0px;" >
		<div align="center">
			<table border="0" style="width: 35%;text-align: left;position: relative;margin-left: 19px;margin:0px 0px 0 28px;">
				<tr style="height: 50px;">
					<td style="width: 140px">
						<div style="position:relative;">
							<img id="firstImg" style=" width: 250px;height: 34px;margin:0px 0px 0 0px;" src="/static/img/step1_select.png"/>
							<div style="position:absolute;z-indent:2;left:50px;top:0;">
								<span style="width: 71px;height: 14px;font-size: 16px;line-height: 32px;letter-spacing: 3px;color: #f9f9f9;">
								1 &nbsp;兼容性检查
							</span>
							</div>
						</div>
					</td>
					<td style="width: 140px">
						<div style="position:relative;">
							<img id="secondImg" style=" width: 250px;height: 34px;margin:0px 0px 0 0px;" src="/static/img/step2.png"/>
							<div style="position:absolute;z-indent:2;left:60px;top:0;">
								<span id="secondText" style="width: 71px;height: 14px;font-size: 16px;line-height: 32px;letter-spacing: 3px;color: #999999;">
								2 &nbsp;条款偏好选择
							</span>
							</div>
						</div>
					</td>
					<td style="width: 140px">
						<div style="position:relative;">
							<img id="thirdImg" style=" width: 250px;height: 34px;margin:0px 0px 0 0px;" src="/static/img/step2.png"/>
							<div style="position:absolute;z-indent:2;left:70px;top:0;">
								<span id="thirdText" style="width: 71px;height: 14px;font-size: 16px;line-height: 32px;letter-spacing: 3px;color: #999999;">
								3 &nbsp;要素对比
							</span>
							</div>
						</div>
					</td>
				</tr>
			</table>
		</div>
	</div>
{% endblock %}

{% block body %}
	<div id="flow_detail"  style="position:absolute;width:1280px;height:490px;z-index:999999;display:none;background:#f8f8f8;border:1px solid #ddd">
		<a id="close_detail" style="position:absolute;display:inline-block;margin:4px 20px 25px 1250px;width:20px;height:20px;line-height:25px;cursor:pointer;border:1px;vertical-align:top;text-align:left;"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" class="bi bi-x-square-fill text-info" viewBox="0 0 16 16"><path d="M2 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2H2zm3.354 4.646L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 1 1 .708-.708z"/></svg></a>
		<!--<table class="table-hover" id="detail_license_table" style="width: 100%; border-collapse:collapse;  border-spacing:0; "></table>-->
		<div class="pre-scrollable" style="margin-top:25px;">
			<ul id="treeDemo" class="ztree"></ul>
		</div>
		<div style="margin-top:5px;margin-left:20px;font-size:14px;border-top:1px solid #ddd;">互不兼容警告：</div>
		<div class="pre-scrollable" style="height:90px;margin-top:2px;margin-left:80px;font-size:12px;">
			<ul id="uncompatibility_list"></ul>
		</div>
	</div>
	<!--开源许可证推荐过程面板-->
	<div class="row">
		<!--左侧栏-->
		<div class="col-xl-9 col-lg-9 col-md-12 col-sm-12">
			<!--第一步：开源许可证识别及兼容性检查-->
			<div id="step1" style="display:block" align="center">
				<div class="selection-label">
					<div  class="secondary-title" align="center">
						<h3>开源许可证兼容性检测</h3>
					</div>
					<div align="center" style="height:375px;">
						<div id="upload_file_box" >
							<div class="box-file" align="center">
								<input type="file" name="file-5[]" id="file-5" class="inputfile inputfile-4" data-multiple-caption="{count} files selected" multiple />
								<label for="file-5"><figure><svg xmlns="http://www.jb51.net" width="20" height="17" viewBox="0 0 20 17"><path d="M10 0l-5.2 4.9h3.3v5.1h3.8v-5.1h3.3l-5.2-4.9zm9.3 11.5l-3.2-2.1h-2l3.4 2.6h-3.5c-.1 0-.2.1-.2.1l-.8 2.3h-6l-.8-2.2c-.1-.1-.1-.2-.2-.2h-3.6l3.4-2.6h-2l-3.2 2.1c-.4.3-.7 1-.6 1.5l.6 3.1c.1.5.7.9 1.2.9h16.3c.6 0 1.1-.4 1.3-.9l.6-3.1c.1-.5-.2-1.2-.7-1.5z"/></svg></figure> <span>选择一个文件上传</br>支持zip和rar格式</span></label>
							</div>
							<div id="progress_nav" style="height:35px;display:none" >
								<div  class="progress-div" >
									<div class="progress">
										<div class="progress-bar progress-bar-striped active" role="progressbar" aria-valuenow="2" aria-valuemin="0" aria-valuemax="100" style="min-width: 0em; width: 0%;">
											0%
										</div>
									</div>
								</div>
								<div id="detecting_log" style="font-size:8px;font-color:gray;">就绪...</div>
							</div>
						</div>
						<div id="in_license_box" style="display:none;" align="left">
							<div align="center" style="margin:0px">项目中已有的开源许可证</div>
							<div id="in_licenses" class="pre-scrollable"  style="height:300px;background:#F8F8F8; color:#222;"></div>
						</div>
						<div id="check_warning" class="pre-scrollable" style="font-size:10px;display:none;height:50px;">
							<span><b>提示：</b></span><span>多重授权中部分许可证（<span id="dual_no_checked"></span>）暂不支持兼容性检测。</span>
						</div>
					</div>
				</div>
			</div>

			<!--第二步：条款解读及偏好选择-->
			<div id="step2" style="display:none">
				<div class="selection-label">
					<div class="secondary-title" align="center">
						<h3>条款解读及偏好选择</h3>
					</div>
					<div id="license_question1" class="terms_question_area">
						<div><p class="question-font">（1）您是否支持“衍生作品采用其他许可证重新分发”的态度？</p></div>
						<div>
							<p class="instruction-font">说明：不同类型的开源许可证反映了您如何看待开源软件（或其他作品）的使用问题，<b>宽松型开源许可证</b>允许用户自由地使用、复制、修改和分发软件，
									且重新分发修改后的软件允许用户重新选择许可方式，甚至闭源，用户拥有更多的自主权；<b>限制型开源许可证</b>允许用户自由地使用、复制、修改和分发软件，
									但重新分发的软件通常须要在相同的开源许可证（或其兼容的开源许可证）下授权，以确保软件的持续开源;将软件放置<b>公共领域</b>，意味着您放弃对软件的版权保护，
									任何人都可以无偿地使用和修改,甚至可以删除您的名字视为其自己的作品。如果您需要考虑<b>开源商业模式</b>和<b>项目社区发展</b>，更多参考请点击<a href="{% url 'ossls:license_type_choice' %}" target="_blank" style="color:blue">这里</a>。
							</p>
						</div>
						<div class="radio-area">
							<div><label><input name="question1" type="radio" style="outline:none" value="宽松型开源许可证" />A、支持，宽松型开源许可证</label></div>
							<div><label><input name="question1" type="radio" style="outline:none" value="限制型开源许可证" />B、不支持，限制型开源许可证</label></div>
							<div><label><input name="question1" type="radio" style="outline:none" value="公共领域许可证" />C、无所谓，将作品放置公共领域</label></div>
						</div>
					</div>
					<div id="license_question2" class="terms_question_area" style="display:none;">
						<div><p class="question-font">（2）您对衍生作品分发的限制性强弱的态度？</p></div>
						<div><p class="instruction-font">说明：开源许可证的”限制性“条款也称”copyleft条款“。<b>“强限制型”</b>许可证要求对软件的修改和扩展后的分发都必须按照获得该软件的许可证进行开源，如GPL2.0；<b>“弱限制型”</b>许可证要求对软件修改后的重新分发必须按照获得该软件的许可证进行授权，
									但允许将代码集成到自己的软件中，而不必使整个代码库开源，合并这些软件的大型作品可以成为私有作品，<b>”文件级/模块级/库级“</b>是指许可证的copyleft范围，如MPL-2.0是弱限制型开源许可证，只要专有代码与MPL-2.0授权代码位于不同文件，即可隔离传染等。</p></div>
						<div class="radio-area">
							<div><label><input name="question2" type="radio" style="outline:none" value="文件级__弱限制型开源许可证" />A、文件级__弱限制型开源许可证</label></div>
							<div><label><input name="question2" type="radio" style="outline:none" value="模块级__弱限制型开源许可证" />B、模块级__弱限制型开源许可证</label></div>
							<div><label><input name="question2" type="radio" style="outline:none" value="强限制型开源许可证" />C、强限制型开源许可证</label></div>
						</div>
					</div>
					<div id="license_question3" class="terms_question_area" style="display:none;">
						<div><p class="question-font">（3）您是否明确“授予专利权”？</p></div>
						<div><p class="instruction-font">说明：软件的可专利性是开源软件正在面临的威胁之一，开源软件中可能包含软件专利，一些开源软件许可证未提及专利授权，
							尽管这可能并不意味着它们不授予专利权（即默示授予专利），然而明确的专利授权有利于保护开源软件的用户免受专利诉讼，尤其是面向一些拥有大量专利组合和其他专利组合风险的企业用户，
							他们普遍很重视专利权的明确授予。</p></div>
						<div class="radio-area">
							<div><label><input name="question3" type="radio" style="outline:none" value="不提及专利权" />A、不提及专利权</label></div>
							<div><label><input name="question3" type="radio" style="outline:none" value="明确授予专利权" />B、明确授予专利权</label></div>
							<div><label><input name="question3" type="radio" style="outline:none" value="明确不授予专利权" />C、明确不授予专利权</label></div>
						</div>
					</div>
					<div id="license_question4" class="terms_question_area" style="display:none;">
						<div><p class="question-font">（4）您是否希望许可证中包含“反专利诉讼”条款？</p></div>
						<div><p class="instruction-font">说明：“反专利诉讼”是指任何提起“声称被许可方侵犯了其在许可作品中的专利权”等此类法律诉讼的人，将失去已经授予其在该许可证中的权利。
							“反专利诉讼”的目的是阻止人们提起关于许可作品的专利诉讼，保护开源软件的用户规避陷入专利诉讼的风险。</p></div>
						<div class="radio-area">
							<div><label><input name="question4" type="radio" style="outline:none" value="包含反专利诉讼条款" />A、包含反专利诉讼条款</label></div>
							<div><label><input name="question4" type="radio" style="outline:none" value="不包含反专利诉讼条款" />B、不包含反专利诉讼条款</label></div>
						</div>
					</div>
					<div id="license_question5" class="terms_question_area" style="display:none;">
						<div><p class="question-font">（5）您是否明确商标权<b style="color:red">限制</b>？</p></div>
						<div><p class="instruction-font">说明：开源软件中可能包含商标，商标权许可将意味着商标所有人失去其对商标的权利，因此，尽管一些开源软件许可证未提及商标权，在使用开源软件时默示不授予商标权；
							还有一些许可证明确不授予商标权，或禁止使用作者的名字来推广软件或销售服务等背书、广告或其他特定行为。
							明确“不授予商标权”有利于保护您的商标合法权益，然而早期出现的一些流行使用的开源许可证可能没有明确包含此条款，例如MIT、BSD-2-Clause、GPL-2.0、GPL-3.0等，
							您也可以通过附加条款、签署其他协议等方式来明确对商标权的限制。</p></div>
						<div class="radio-area">
							<div><label><input name="question5" type="radio" style="outline:none" value="不提及商标权" />A、不提及商标权</label></div>
							<div><label><input name="question5" type="radio" style="outline:none" value="明确不授予商标权" />B、明确不授予商标权</label></div>
						</div>
					</div>
					<div id="license_question6" class="terms_question_area" style="display:none;">
						<div><p class="question-font">（6）您对用户使用开源软件或其衍生软件进行“网络交互”的态度？</p></div>
						<div><p class="instruction-font">说明：“网络交互”是指向用户使用开源软件为他人提供在线服务等行为，即使软件的物理副本并未被分发。
									”网络交互视为分发“是指用户使用开源软件或其衍生软件进行”网络交互“，须按照获得该软件的许可证授权并分发其源代码，
									例如在云中使用AGPL-3.0授权的软件提供在线服务也须要发布其源代码。</p></div>
						<div class="radio-area">
							<div><label><input name="question6" type="radio" style="outline:none" value="网络部署视为分发" />A、网络交互视为分发</label></div>
							<div><label><input name="question6" type="radio" style="outline:none" value="网络部署不视为分发" />B、网络交互不视为分发</label></div>
						</div>
					</div>
					<div id="license_question7" class="terms_question_area" style="display:none;">
						<div><p class="question-font">（7）您是否希望用户为其制作的衍生软件添加“修改说明”？</p></div>
						<div><p class="instruction-font">说明：“修改说明”是指要求用户在分发其修改后的软件（衍生软件）时，必须标记修改内容、日期、修改作者等信息。
							“修改说明”有利于增强开源软件贡献者的可见性和软件的可维护性；然而，用户可能因为疏忽导致许可证违规；且该条款的存在与否将影响开源许可证的兼容性。</p></div>
						<div class="radio-area">
							<div><label><input name="question7" type="radio" style="outline:none" value="包含修改说明条款" />A、是，包含”修改说明“</label></div>
							<div><label><input name="question7" type="radio" style="outline:none" value="不包含修改说明条款" />B、否，不包含“修改说明”</label></div>
						</div>
					</div>
				</div>
			</div>

			<!--	许可证要素对比		-->
			<div id="step3" style="display:none">
				<div class="selection-label">
					<div class="secondary-title" align="center" >
							<h3>许可证要素对比</h3>
					</div>
					<div class="terms_question_area">
						<table class="table table-hover" id="license_compare" style="border-collapse:separate; border-spacing:3px;text-align:center; "></table>
					</div>
				</div>
			</div>
		</div>

			<!--右侧栏-->
		<div class="col-xl-3 col-lg-3 col-md-4 col-sm-4 ">
			<div class="selection-label">
				<div class="recommend-title" id="licenselist_title" align="center">
					<h3>开源许可证推荐列表</h3>
				</div>
				<div style="height:375px;">
					<div class="dropdown-button" align="center" >
						<select id="sort_selection" class="selectpicker show-tick"  data-width="98%">
							<option value="popular_desc" style="outline:none" selected="selected">按流行度降序↓</option>
							<option value="popular_asc" style="outline:none">按流行度升序↑</option>
							<option value="complex_desc" style="outline:none">按可读性降序↓</option>
							<option value="complex_asc" style="outline:none">按可读性升序↑</option>
						</select>
					</div>
					<div class="recommand-license" align="left">
						<ul class="pre-scrollable" id="licenselist_recommended" >
							{% for license in licenses %}
							<li class="recommand-license-li" value={{popular_dict|get_licensename:license}}><svg xmlns="http://www.w3.org/2000/svg" width="30" height="14" fill="currentColor" class="bi bi-circle" viewBox="0 0 16 16"><path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z"/></svg>{{license}}</li>
							{% endfor %}
						</ul>
					</div>
				</div>
			</div>
		</div>
	</div>
	<div class="row" style="margin:10;padding:0;">
		<div class="col-xl-9 col-lg-9" align="center" style="margin:10;padding:0;">
			<div id="step1_button" style="display:block;">
				<div align="center" class="button-filed" style="padding:0px 50px;display:inline-block;">
					<button id="step1button" >检  查</button>
				</div>
				<div align="center" class="button-filed" style="padding:0px 50px;display:inline-block;">
					<button id="files_license_detail" >详情</button>
				</div>
			</div>
			<div id="step2_button" style="display:none;">
				<div align="center" class="button-filed" style="padding:0px 50px">
					<button id="above_question" style="display:none;">上一题</button>
							&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
					<button id="next_question" style="display:inline-block;">下一题</button>
				</div>
			</div>
			<div id="step3_button" style="display:none;">
				<div align="center" class="button-filed" style="padding:0px 50px">
					<a href="{% url 'ossls:license_trend' %}" target="_blank"><button id="license_trend" >趋势一览</button></a>
				</div>
			</div>
		</div>
		<div class="col-xl-3 col-lg-3" align="center">
			<div align="center" class="button-filed" style="padding:0px 50px">
				<button id="skip_or_next_button" >跳 过</button>
			</div>
		</div>
	</div>
	<div class="row">
		<div class="col-xl-12 col-lg-12 col-md-12 col-sm-12" id="step1_instruction" style="margin:20px;padding:0;" align="left">
			<div class="instruction-area">
				<p style="font-size:15px;"><b>说明：</b>
					"项目中已有的开源许可证"列举的许可证指从项目包中识别的开源许可证，other表示项目包中可能存在不支持识别的许可证，须人工检查，具体授权信息可查看“详情”；
					<svg xmlns='http://www.w3.org/2000/svg' width='30' height='15' fill='currentColor' class='bi bi-check-circle color-both' viewBox='0 0 16 16'>  <path d='M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z'/>  <path d='M10.97 4.97a.235.235 0 0 0-.02.022L7.477 9.417 5.384 7.323a.75.75 0 0 0-1.06 1.06L6.97 11.03a.75.75 0 0 0 1.079-.02l3.992-4.99a.75.75 0 0 0-1.071-1.05z'/></svg>表示支持兼容性检测的许可证，
					<svg xmlns='http://www.w3.org/2000/svg' width='30' height='15' fill='currentColor' class='bi bi-exclamation-circle' viewBox='0 0 16 16'>  <path d='M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z'/>  <path d='M7.002 11a1 1 0 1 1 2 0 1 1 0 0 1-2 0zM7.1 4.995a.905.905 0 1 1 1.8 0l-.35 3.507a.552.552 0 0 1-1.1 0L7.1 4.995z'/></svg>表示本工具暂时不支持兼容性检测的许可证，须人工检查；
					"开源许可证推荐列表"来源于包括Github和Libraries.io上最广泛使用的20个开源软件许可证；
					<svg xmlns='http://www.w3.org/2000/svg' width='30' height='14' fill='currentColor' class='bi bi-circle-fill color-both' viewBox='0 0 16 16'><circle cx='8' cy='8' r='8'/></svg>表示满足“次级兼容”和“组合兼容”的许可证，
					<svg xmlns='http://www.w3.org/2000/svg' width='30' height='14' fill='currentColor' class='bi bi-circle-fill color-secondary' viewBox='0 0 16 16'><circle cx='8' cy='8' r='8'/></svg>表示仅满足“次级兼容”的许可证，
					<svg xmlns='http://www.w3.org/2000/svg' width='30' height='14' fill='currentColor' class='bi bi-circle-fill color-compatibility' viewBox='0 0 16 16'><circle cx='8' cy='8' r='8'/></svg>表示仅满足“组合兼容”的许可证；
					次级兼容和组合兼容的概念请查看<a href="{% url 'ossls:license_compatibility' %}" target="_blank" style="color:blue">这里</a>。</p>
			</div>
		</div>
		<div class="col-xl-12 col-lg-12 col-md-12 col-sm-12" id="step2_instruction" style="margin:20px;padding:0;display:none;" align="left">
			<div class="instruction-area">
				<p style="font-size:8px;"><b>您选择的条款是：</b></p>
				<div class="plus-tag tagbtn clearfix" id="terms_choice" ></div>
			</div>

		</div>
	</div>
{% endblock %}

{% block extraJS %}
	<!--文件上传JS-->
	<script src="/static/js/custom-file-input.js"></script>
	<!--HTML页面元素排序JS-->
	<script src="/static/js/jquery.jsort.0.4.js"></script>
	<!--单选列表JS-->
	<script type="text/javascript" src="/static/js/bootstrap-select.js"></script>
	<!--文件树生成JS-->
	<script type="text/javascript" src="/static/js/jquery.ztree.core.js"></script>

	<div style="display:none"><script src="http://demo.jb51.net/js/tj.js"></script></div>
	<script src="http://demo.jb51.net/js/yxj.js" type="text/javascript"></script>

	<!--Bootstrap JS-->
	<script src="https://cdn.staticfile.org/twitter-bootstrap/3.3.7/js/bootstrap.min.js"></script>
	<script>
		//该步骤执行之前的推荐列表
		var init_licenselist = [];
		//当前的推荐列表
		var cur_licenselist = [];
		var compare_licenselist = [];
		var blue_license = [];
		var yellow_license = [];
		var green_license = [];
		var black_license = [];
		//当前页面显示的问题序号
		var cur_question = 1;
		//第2题的显示状态，1为显示，2为跳过
		var q2_show = 1;
		var popular_dict = {{popular_dict|safe}};
		var complex_dict = {};
		var license_popular_asc = 0;
		var license_complex_asc = -1;
		for (var i = 0; i < $("#licenselist_recommended").find("li").length; i++){
			black_license[i] = $("#licenselist_recommended").children("li").eq(i).text();
		}

		//文件树配置
		var setting = {
            data: {
                key: {
                    title: "t",
                    name: "name",
                    font:"font",
                },
                simpleData: {
                    enable: true,
                    idKey: "id",
                    pIdKey: "Pid",
                    rootPId: 0
                }
            },
            view:{
                fontCss: setFontCss,
            },
            callback: {
                beforeClick: beforeClick,
                onClick: onClick,

            }

        };
        function setFontCss(treeId,treeNode){
			return treeNode.font ? treeNode.font : {};
        }

        var log, className = "dark";
        function beforeClick(treeId, treeNode, clickFlag) {
            className = (className === "dark" ? "" : "dark");
            showLog("[ " + getTime() + " beforeClick ]&nbsp;&nbsp;" + treeNode.name);
            return (treeNode.click != false);
        }
        function onClick(event, treeId, treeNode, clickFlag) {
            showLog("[ " + getTime() + " onClick ]&nbsp;&nbsp;clickFlag = " + clickFlag + " (" + (clickFlag === 1 ? "普通选中" : (clickFlag === 0 ? "<b>取消选中</b>" : "<b>追加选中</b>")) + ")");
        }
        function showLog(str) {
            if (!log) log = $("#log");
            log.append("<li class='" + className + "'>" + str + "</li>");
            if (log.children("li").length > 8) {
                log.get(0).removeChild(log.children("li")[0]);
            }
        }
        function getTime() {
            var now = new Date(),
                h = now.getHours(),
                m = now.getMinutes(),
                s = now.getSeconds();
            return (h + ":" + m + ":" + s);
        }

		<!--下一步或跳过按钮-->
		$("#skip_or_next_button").click(function(e){
			for (var i = 0; i < $("#licenselist_recommended").find("li").length; i++){
					init_licenselist[i] = $("#licenselist_recommended").children("li").eq(i).text();
			}
			if($("#step1").is(':visible')){
				$("#step1").hide();
				$("#step1_button").hide();
				$("#step1_instruction").hide();
				$("#step2").show();
				$("#step2_button").show();
				$("#step2_instruction").show();
				$("#skip_or_next_button").text("下一步");
				$("#secondImg").attr("src", "/static/img/step2_select.png");
				$("#secondText").css('color','#f9f9f9');
			}
			else if($("#step2").is(':visible')){
				$("#step2").hide();
				$("#step2_button").hide();
				$("#step2_instruction").hide();
				$("#step3").show();
				$("#step3_button").show();
				$("#skip_or_next_button").text("重 试");
				$("#thirdImg").attr("src", "/static/img/step2_select.png");
				$("#thirdText").css('color','#f9f9f9');
				for (var i = 0; i < $("#licenselist_recommended").find("li").length; i++){
					compare_licenselist[i] = $("#licenselist_recommended").children("li").eq(i).text();
				}
				console.log(compare_licenselist);
				var $license_compare = $("#license_compare");
				var tableStr;
				$("#license_compare").empty("");
				$.ajax({
					dataType: 'JSON',
					cache: false,
					async: true,
					type: 'POST',
					url:"{% url 'ossls:license_compare' %}",
					traditional:true,
					data:{
						compare_licenselist:compare_licenselist,
					},
					beforeSend:function(xhr,settings){
						xhr.setRequestHeader("X-CSRFToken","{{csrf_token}}");
					},
					success:function(result){
						var $tr = null;
						$tr = $tr + "<td style='width:13%;'>"+ '许可证SPDX' +"</td>";
						$tr = $tr + "<td>"+ '基</br>本</br>信</br>息' +"</td>";
						$tr = $tr + "<td>"+ '序</br>言' +"</td>";
						$tr = $tr + "<td>"+ '定</br>义' +"</td>";
						$tr = $tr + "<td>"+ '版</br>权' +"</td>";
						$tr = $tr + "<td>"+ '专</br>利</br>权' +"</td>";
						$tr = $tr + "<td>"+ '商</br>标</br>权' +"</td>";
						$tr = $tr + "<td style='width:8%;'>"+ '分</br>发</br>限</br>制' +"</td>";
						$tr = $tr + "<td>"+ '网</br>络</br>部</br>署' +"</td>";
						$tr = $tr + "<td>"+ '保</br>留</br>归</br>属' +"</td>";
						$tr = $tr + "<td>"+ '增</br>强</br>归</br>属' +"</td>";
						$tr = $tr + "<td>"+ '修</br>改</br>声</br>明' +"</td>";
						$tr = $tr + "<td>"+ '接</br>受</br>许</br>可' +"</td>";
						$tr = $tr + "<td>"+ '授</br>权</br>终</br>止' +"</td>";
						$tr = $tr + "<td>"+ '专</br>利</br>终</br>止' +"</td>";
						$tr = $tr + "<td style='width:6%;'>"+ '准</br>据</br>法' +"</td>";
						$tr = $tr + "<td>"+ '担</br>保</br>免</br>责' +"</td>";
						$tr = $tr + "<td style='width:7%;'>"+ '使</br>用</br>说</br>明' +"</td>";
						$tr= "<thead class='thead-light'>"+"<tr style='display:table;width:100%;table-layout:fixed;font-size:10px;text-align:center;'>"+$tr+"</tr>"+"</thead>";
						$license_compare.append( $tr);
						$license_compare.append("<tbody class='bg-light' style='display: block; height: 280px; overflow-y: scroll;'>");
						for( var i = 0; i < result['compared_licenselist'].length; i++ ) {
								//动态创建一个tr行标签,并且转换成jQuery对象
								var $trTemp = $("<tr style='display:table;table-layout:fixed;width:100%;font-size:10px;text-align:center;'></tr>");
								//往行里面追加 td单元格
								$trTemp.append("<td style='width:13%;'>"+ result['compared_licenselist'][i].license +"</td>");

								if(result['compared_licenselist'][i].info == 0) $trTemp.append("<td>&#9898</td>");
								else if(result['compared_licenselist'][i].info == 1 ) $trTemp.append("<td>&#9899</td>");

								if(result['compared_licenselist'][i].preamble == 0) $trTemp.append("<td>&#9898</td>");
								else if(result['compared_licenselist'][i].preamble == 1 ) $trTemp.append("<td>&#9899</td>");

								if(result['compared_licenselist'][i].define == 0) $trTemp.append("<td>&#9898</td>");
								else if(result['compared_licenselist'][i].define == 1 ) $trTemp.append("<td>&#9899</td>");

								if(result['compared_licenselist'][i].copyright == 0) $trTemp.append("<td>&#9898</td>");
								else if(result['compared_licenselist'][i].copyright == 1 ) $trTemp.append("<td>&#9899</td>");
								else if(result['compared_licenselist'][i].copyright == -1 ) $trTemp.append("<td>&#935;</td>");

								if(result['compared_licenselist'][i].patent == -1) $trTemp.append("<td>&#935;</td>");
								else if(result['compared_licenselist'][i].patent == 0 || result['compared_licenselist'][i].patent == -1) $trTemp.append("<td>&#9898</td>");
								else if(result['compared_licenselist'][i].patent == 1 ) $trTemp.append("<td>&#9899</td>");


								if(result['compared_licenselist'][i].trademark == 0) $trTemp.append("<td>&#9898</td>");
								else if(result['compared_licenselist'][i].trademark == 1 ) $trTemp.append("<td>&#9899</td>");

								if(result['compared_licenselist'][i].copyleft == 0 || result['compared_licenselist'][i].copyleft == -1) $trTemp.append("<td style='width:8%;'>无限制</td>");
								else if(result['compared_licenselist'][i].copyleft == 1 ) $trTemp.append("<td style='width:8%;'>文件级弱限制</td>");
								else if(result['compared_licenselist'][i].copyleft == 2 ) $trTemp.append("<td style='width:8%;'>库级弱限制</td>");
								else if(result['compared_licenselist'][i].copyleft == 3 ) $trTemp.append("<td style='width:8%;'>强限制</td>");

								if(result['compared_licenselist'][i].interaction == 0) $trTemp.append("<td>&#9898</td>");
								else if(result['compared_licenselist'][i].interaction == 1 ) $trTemp.append("<td>&#9899</td>");

								if(result['compared_licenselist'][i].retain_attr == 0) $trTemp.append("<td>&#9898</td>");
								else if(result['compared_licenselist'][i].retain_attr == 1 ) $trTemp.append("<td>&#9899</td>");

								if(result['compared_licenselist'][i].enhance_attr  == 0) $trTemp.append("<td>&#9898</td>");
								else if(result['compared_licenselist'][i].enhance_attr  == 1 ) $trTemp.append("<td>&#9899</td>");

								if(result['compared_licenselist'][i].modification == 0) $trTemp.append("<td>&#9898</td>");
								else if(result['compared_licenselist'][i].modification == 1 ) $trTemp.append("<td>&#9899</td>");

								if(result['compared_licenselist'][i].acceptance == 0) $trTemp.append("<td>&#9898</td>");
								else if(result['compared_licenselist'][i].acceptance == 1 ) $trTemp.append("<td>&#9899</td>");

								if(result['compared_licenselist'][i].vio_term == 0) $trTemp.append("<td>&#9898</td>");
								else if(result['compared_licenselist'][i].vio_term == 1 ) $trTemp.append("<td>&#9899</td>");

								if(result['compared_licenselist'][i].patent_term == 0) $trTemp.append("<td>&#9898</td>");
								else if(result['compared_licenselist'][i].patent_term == 1 ) $trTemp.append("<td>&#9899</td>");

								if(result['compared_licenselist'][i].law == 0) $trTemp.append("<td style='width:6%;'>"+ "无" +"</td>");
								else $trTemp.append("<td style='width:6%;'>"+ result['compared_licenselist'][i].law +"</td>");

								if(result['compared_licenselist'][i].disclaimer == 0) $trTemp.append("<td>&#9898</td>");
								else if(result['compared_licenselist'][i].disclaimer == 1 ) $trTemp.append("<td>&#9899</td>");

								if(result['compared_licenselist'][i].instruction == 0) $trTemp.append("<td>&#9898</td>");
								else if(result['compared_licenselist'][i].instruction == 1 ) $trTemp.append("<td>&#9899</td>");

								$trTemp.appendTo($license_compare);
						}
						$license_compare.append("</tbody>");
					},
					error:function(){
						alert("服务端连接失败，请刷新重试");
					},
				});
			}
			else if($("#step3").is(':visible')){
				$("#step1").show();
				$("#step1_button").show();
				$("#step1_instruction").show();
				$("#step3").hide();
				$("#step3_button").hide();
				$("#skip_or_next_button").text("下一步");
				location.reload(true);
				cur_question = 1;
				curstep_init_licenselist = [];
				q2_show = 1;
			}
		});

		<!--兼容性检查按钮-->
		$("#step1button").click(function(e){
			$("#progress_nav").show();
			$("#detecting_log").text("文件解压中，请稍后…………");
			$('.progress-bar').css('width', '1%');
			$('.progress-bar').text('1%');
			var sitv = setInterval(function(){
				var prog_url = "{% url 'ossls:show_progress' %}"
				$.getJSON(prog_url, function(num_progress){
					$('.progress-bar').css('width', num_progress + '%');
					$('.progress-bar').text(num_progress + '%');
					if(num_progress > 1 && num_progress < 99){
						$("#detecting_log").text("许可证识别中，请稍后…………");
					}
					if(num_progress >= 99){
						clearInterval(sitv);
						$('.progress-bar').css('width', '99%');
						$('.progress-bar').text('99%');
						$("#detecting_log").text("依赖解析中，请稍后…………");
					}
				});
			},5);
			var file = document.getElementById('file-5').files[0];
			var formData = new FormData();
			formData.append("FILE",file);
			$.ajax({
				type: 'POST',
				url:"{% url 'ossls:license_check' %}",
				data:formData,
				contentType: false,
                processData: false,
                beforeSend:function(xhr,settings){
					xhr.setRequestHeader("X-CSRFToken","{{csrf_token}}");
				},
				success:function(result){
					if(result['in_licenses']=='error'){
						$("#in_licenses").text(" ");
						alert("请选择一个文件上传！")
					}
					else if(result['in_licenses']=='error2'){
						$("#in_licenses").text(" ");
						alert("请选择一个支持的文件类型！")
					}
					else{
						$("#detecting_log").text("完成...");
						$("#in_licenses").text('');
						$('.progress-bar').css('width', '100%');
						$('.progress-bar').text('100%');
						$("#upload_file_box").hide();
						$("#in_license_box").show();
						for(var i = 0; i < result['in_licenses'].length; i++){
							if(result['checked_list'].includes(result['in_licenses'][i])){
								$("#in_licenses").append("<li class='recommand-license-li'><svg xmlns='http://www.w3.org/2000/svg' width='30' height='15' fill='currentColor' class='bi bi-check-circle color-both' viewBox='0 0 16 16'>  <path d='M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z'/>  <path d='M10.97 4.97a.235.235 0 0 0-.02.022L7.477 9.417 5.384 7.323a.75.75 0 0 0-1.06 1.06L6.97 11.03a.75.75 0 0 0 1.079-.02l3.992-4.99a.75.75 0 0 0-1.071-1.05z'/></svg>"+result['in_licenses'][i]+"</li>");
							}
							else{
								$("#in_licenses").append("<li class='recommand-license-li'><svg xmlns='http://www.w3.org/2000/svg' width='30' height='15' fill='currentColor' class='bi bi-exclamation-circle' viewBox='0 0 16 16'>  <path d='M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z'/>  <path d='M7.002 11a1 1 0 1 1 2 0 1 1 0 0 1-2 0zM7.1 4.995a.905.905 0 1 1 1.8 0l-.35 3.507a.552.552 0 0 1-1.1 0L7.1 4.995z'/></svg>"+result['in_licenses'][i]+"</li>");
							}
						}
						if(result['dual_no_checked'].length > 0){
							$("#dual_no_checked").text(result['dual_no_checked']);
							$("#check_warning").show();
						}
						$("#skip_or_next_button").text("下一步");
						$("#files_license_detail").click(function(e){
							$.fn.zTree.init($("#treeDemo"), setting, result['json_list']);
							$("#uncompatibility_list").find("li").remove();
							for(var i = 0; i < result['conflict_copyleft_list'].length; i++){
								$("#uncompatibility_list").append("<li>"+result['conflict_copyleft_list'][i]+"</li>");
							}
							$('#flow_detail').show();
						});
						$("#close_detail").click(function(e){
							$('#flow_detail').hide();
						});
						$("#licenselist_recommended").find("li").remove();
						for (var i = 0; i < result["licenselist_recommended"].length; i++){
							if(result["compatible_secondary_list"].includes(result["licenselist_recommended"][i])) {$("#licenselist_recommended").append("<li class='recommand-license-li' value=0><svg xmlns='http://www.w3.org/2000/svg' width='30' height='14' fill='currentColor' class='bi bi-circle-fill color-secondary' viewBox='0 0 16 16'><circle cx='8' cy='8' r='8'/></svg>" + result["licenselist_recommended"][i] + "</li>");	green_license.push(result["licenselist_recommended"][i]);black_license.pop(result["licenselist_recommended"][i]);}
							else if(result["compatible_combine_list"].includes(result["licenselist_recommended"][i])) {$("#licenselist_recommended").append("<li class='recommand-license-li' value=0><svg xmlns='http://www.w3.org/2000/svg' width='30' height='14' fill='currentColor' class='bi bi-circle-fill color-compatibility' viewBox='0 0 16 16'><circle cx='8' cy='8' r='8'/></svg>" + result["licenselist_recommended"][i] + "</li>");	yellow_license.push(result["licenselist_recommended"][i]);black_license.pop(result["licenselist_recommended"][i]);}
							else if(result["compatible_both_list"].includes(result["licenselist_recommended"][i])){$("#licenselist_recommended").append("<li class='recommand-license-li' value=0><svg xmlns='http://www.w3.org/2000/svg' width='30' height='14' fill='currentColor' class='bi bi-circle-fill color-both' viewBox='0 0 16 16'><circle cx='8' cy='8' r='8'/></svg>" + result["licenselist_recommended"][i] + "</li>");blue_license.push(result["licenselist_recommended"][i]);black_license.pop(result["licenselist_recommended"][i]);}
						}
						$("#licenselist_recommended").show()
						clearInterval(sitv);
					}
				},
				error:function(){
					alert("服务端连接失败，请刷新重试");
				},
			})
		});

		$(document).ready(function(){
			$('input[type=radio]').change(function(){
				$.ajax({
					dataType: 'JSON',
					cache: false,
					async: true,
					type: 'POST',
					url:"{% url 'ossls:license_terms_choice' %}",
					traditional:true,
					data:{
						question1_val:$('input[name="question1"]:checked').val(),
						question2_val:$('input[name="question2"]:checked').val(),
						question3_val:$('input[name="question3"]:checked').val(),
						question4_val:$('input[name="question4"]:checked').val(),
						question5_val:$('input[name="question5"]:checked').val(),
						question6_val:$('input[name="question6"]:checked').val(),
						question7_val:$('input[name="question7"]:checked').val(),
						init_licenselist:init_licenselist,
						cur_question:cur_question,
					},
					beforeSend:function(xhr,settings){
						xhr.setRequestHeader("X-CSRFToken","{{csrf_token}}");
					},
					success:function(result){
						q2_show = result["q2_show"]
						$("#licenselist_recommended").find("li").remove();
						for (var i = 0; i < result["licenselist_recommended"].length; i++){
							if(yellow_license.includes(result["licenselist_recommended"][i])){$("#licenselist_recommended").append("<li class='recommand-license-li' value=0><svg xmlns='http://www.w3.org/2000/svg' width='30' height='14' fill='currentColor' class='bi bi-circle-fill color-compatibility' viewBox='0 0 16 16'><circle cx='8' cy='8' r='8'/></svg>" + result["licenselist_recommended"][i] + "</li>");}
							else if(green_license.includes(result["licenselist_recommended"][i])){$("#licenselist_recommended").append("<li class='recommand-license-li' value=0><svg xmlns='http://www.w3.org/2000/svg' width='30' height='14' fill='currentColor' class='bi bi-circle-fill color-secondary' viewBox='0 0 16 16'><circle cx='8' cy='8' r='8'/></svg>" + result["licenselist_recommended"][i] + "</li>");}
							else if(blue_license.includes(result["licenselist_recommended"][i])){$("#licenselist_recommended").append("<li class='recommand-license-li' value=0><svg xmlns='http://www.w3.org/2000/svg' width='30' height='14' fill='currentColor' class='bi bi-circle-fill color-both' viewBox='0 0 16 16'><circle cx='8' cy='8' r='8'/></svg>" + result["licenselist_recommended"][i] + "</li>");}
							else if(black_license.includes(result["licenselist_recommended"][i])){$("#licenselist_recommended").append("<li class='recommand-license-li' value=0><svg xmlns='http://www.w3.org/2000/svg' width='30' height='14' fill='currentColor' class='bi bi-circle' viewBox='0 0 16 16'><path d='M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z'/></svg>" + result["licenselist_recommended"][i] + "</li>");}
						}
						$("#terms_choice").find("a").remove();
						for(var i = 0; i < result["terms_choice"].length; i++){
							var term_choice_tab = $("#terms_choice");
							term_choice_tab.append($("<a><span>"+result["terms_choice"][i]+"</span></a>"));
						}
						if(license_popular_asc == "1"){
							for (var i = 0; i < $("#licenselist_recommended").find("li").length; i++){
								$("#licenselist_recommended").children("li").eq(i).attr("value",popular_dict[$("#licenselist_recommended").children("li").eq(i).text()]);
							}
							var sort_divlist = $("#licenselist_recommended li").get();
							sort_divlist.sort(function(a,b){
								var el_a = parseInt($(a).attr('value'));
								var el_b = parseInt($(b).attr('value'));
								if(el_a > el_b) return 1;
								if(el_a < el_b) return -1;
								return 0;
							});
							$("#licenselist_recommended").append(sort_divlist);
						}
						else if(license_popular_asc == "0"){
							console.log(license_popular_asc);
							for (var i = 0; i < $("#licenselist_recommended").find("li").length; i++){
								$("#licenselist_recommended").children("li").eq(i).attr("value",popular_dict[$("#licenselist_recommended").children("li").eq(i).text()]);
							}
							var sort_divlist = $("#licenselist_recommended li").get();
							sort_divlist.sort(function(a,b){
								var el_a = parseInt($(a).attr('value'));
								var el_b = parseInt($(b).attr('value'));
								if(el_a > el_b) return -1;
								if(el_a < el_b) return 1;
								return 0;
							});
							$("#licenselist_recommended").append(sort_divlist);
						}
						else if(license_complex_asc == "0"){
							for (var i = 0; i < $("#licenselist_recommended").find("li").length; i++){
								$("#licenselist_recommended").children("li").eq(i).attr("value",complex_dict[$("#licenselist_recommended").children("li").eq(i).text()]);
							}
							var sort_divlist = $("#licenselist_recommended li").get();
							sort_divlist.sort(function(a,b){
								var el_a = parseInt($(a).attr('value'));
								var el_b = parseInt($(b).attr('value'));
								if(el_a > el_b) return 1;
								if(el_a < el_b) return -1;
								return 0;
							});
							$("#licenselist_recommended").append(sort_divlist);
						}
						else if(license_complex_asc == "1"){
							for (var i = 0; i < $("#licenselist_recommended").find("li").length; i++){
								$("#licenselist_recommended").children("li").eq(i).attr("value",complex_dict[$("#licenselist_recommended").children("li").eq(i).text()]);
							}
							var sort_divlist = $("#licenselist_recommended li").get();
							sort_divlist.sort(function(a,b){
								var el_a = parseInt($(a).attr('value'));
								var el_b = parseInt($(b).attr('value'));
								if(el_a > el_b) return -1;
								if(el_a < el_b) return 1;
								return 0;
							});
							$("#licenselist_recommended").append(sort_divlist);
						}
					},
					error:function(){
						alert("服务端连接失败，请刷新重试");
					},
				});
			});
		});

		<!--条款分析上一题按钮-->
		$("#above_question").click(function(e){
			if(cur_question <= 7){$('input[name="question7"]:checked').prop("checked",false);}
			if(cur_question <= 6){$('input[name="question7"]:checked').prop("checked",false);$('input[name="question6"]:checked').prop("checked",false);}
			if(cur_question <= 5){$('input[name="question7"]:checked').prop("checked",false);$('input[name="question6"]:checked').prop("checked",false);$('input[name="question5"]:checked').prop("checked",false);}
			if(cur_question <= 4){$('input[name="question7"]:checked').prop("checked",false);$('input[name="question6"]:checked').prop("checked",false);$('input[name="question5"]:checked').prop("checked",false);$('input[name="question4"]:checked').prop("checked",false);}
			if(cur_question <= 3){$('input[name="question7"]:checked').prop("checked",false);$('input[name="question6"]:checked').prop("checked",false);$('input[name="question5"]:checked').prop("checked",false);$('input[name="question4"]:checked').prop("checked",false);$('input[name="question3"]:checked').prop("checked",false);}
			if(cur_question <= 2){$('input[name="question7"]:checked').prop("checked",false);$('input[name="question6"]:checked').prop("checked",false);$('input[name="question5"]:checked').prop("checked",false);$('input[name="question4"]:checked').prop("checked",false);$('input[name="question3"]:checked').prop("checked",false);$('input[name="question2"]:checked').prop("checked",false);}
			if(cur_question <= 1){$('input[name="question7"]:checked').prop("checked",false);$('input[name="question6"]:checked').prop("checked",false);$('input[name="question5"]:checked').prop("checked",false);$('input[name="question4"]:checked').prop("checked",false);$('input[name="question3"]:checked').prop("checked",false);$('input[name="question2"]:checked').prop("checked",false);$('input[name="question1"]:checked').prop("checked",false);}

			if($("#license_question2").is(':visible')){
				$("#license_question2").hide();
				$("#license_question1").show();
				$("#above_question").toggle();
				cur_question--;
			}
			if($("#license_question3").is(':visible')){
				if(q2_show == 0){
					$("#license_question3").hide();
					$("#license_question1").show();
					$("#above_question").toggle();
					$("#skip_or_next_button").text("下一步");
					cur_question--;
					cur_question--;
				}
				else if(q2_show == 1){
					$("#license_question3").hide();
					$("#license_question2").show();
					$("#skip_or_next_button").text("下一步");
					cur_question--;
				}
			}
			else if($("#license_question4").is(':visible')){
				$("#license_question4").hide();
				$("#license_question3").show();
				cur_question--;
			}
			else if($("#license_question5").is(':visible')){
				$("#license_question5").hide();
				$("#license_question4").show();
				cur_question--;
			}
			else if($("#license_question6").is(':visible')){
				$("#license_question6").hide();
				$("#license_question5").show();
				cur_question--;
			}
			else if($("#license_question7").is(':visible')){
				$("#license_question7").hide();
				$("#license_question6").show();
				$("#next_question").toggle();
				$("#next_question").text("下一题");
				cur_question--;
			}
			$.ajax({
					dataType: 'JSON',
					cache: false,
					async: true,
					type: 'POST',
					url:"{% url 'ossls:license_terms_choice' %}",
					traditional:true,
					data:{
						question1_val:$('input[name="question1"]:checked').val(),
						question2_val:$('input[name="question2"]:checked').val(),
						question3_val:$('input[name="question3"]:checked').val(),
						question4_val:$('input[name="question4"]:checked').val(),
						question5_val:$('input[name="question5"]:checked').val(),
						question6_val:$('input[name="question6"]:checked').val(),
						question7_val:$('input[name="question7"]:checked').val(),
						init_licenselist:init_licenselist,
						cur_question:cur_question,
					},
					beforeSend:function(xhr,settings){
						xhr.setRequestHeader("X-CSRFToken","{{csrf_token}}");
					},
					success:function(result){
						q2_show = result["q2_show"]
						$("#licenselist_recommended").find("li").remove();
						for (var i = 0; i < result["licenselist_recommended"].length; i++){
							if(yellow_license.includes(result["licenselist_recommended"][i])){$("#licenselist_recommended").append("<li class='recommand-license-li' value=0><svg xmlns='http://www.w3.org/2000/svg' width='30' height='14' fill='currentColor' class='bi bi-circle-fill color-compatibility' viewBox='0 0 16 16'><circle cx='8' cy='8' r='8'/></svg>" + result["licenselist_recommended"][i] + "</li>");}
							else if(green_license.includes(result["licenselist_recommended"][i])){$("#licenselist_recommended").append("<li class='recommand-license-li' value=0><svg xmlns='http://www.w3.org/2000/svg' width='30' height='14' fill='currentColor' class='bi bi-circle-fill color-secondary' viewBox='0 0 16 16'><circle cx='8' cy='8' r='8'/></svg>" + result["licenselist_recommended"][i] + "</li>");}
							else if(blue_license.includes(result["licenselist_recommended"][i])){$("#licenselist_recommended").append("<li class='recommand-license-li' value=0><svg xmlns='http://www.w3.org/2000/svg' width='30' height='14' fill='currentColor' class='bi bi-circle-fill color-both' viewBox='0 0 16 16'><circle cx='8' cy='8' r='8'/></svg>" + result["licenselist_recommended"][i] + "</li>");}
							else if(black_license.includes(result["licenselist_recommended"][i])){$("#licenselist_recommended").append("<li class='recommand-license-li' value=0><svg xmlns='http://www.w3.org/2000/svg' width='30' height='14' fill='currentColor' class='bi bi-circle' viewBox='0 0 16 16'><path d='M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z'/></svg>" + result["licenselist_recommended"][i] + "</li>");}
						}
						$("#terms_choice").find("a").remove();
						for(var i = 0; i < result["terms_choice"].length; i++){
							var term_choice_tab = $("#terms_choice");
							term_choice_tab.append($("<a><span>"+result["terms_choice"][i]+"</span></a>"));
						}
					},
					error:function(){
						alert("服务端连接失败，请刷新重试");
					},
			});
		});

		<!--条款分析下一题按钮-->
		$("#next_question").click(function(e){
			if($("#license_question1").is(':visible')){
				cur_question++;
				$("#above_question").toggle();
				if(q2_show == 0){
					$("#license_question1").hide();
					$("#license_question3").show();
					$("#skip_or_next_button").text("下一步");
					cur_question++;
				}
				else if(q2_show == 1){
					$("#license_question1").hide();
					$("#license_question2").show();
					$("#skip_or_next_button").text("下一步");
				}
			}
			else if($("#license_question2").is(':visible')){
				$("#license_question2").hide();
				$("#license_question3").show();
				cur_question++;
			}
			else if($("#license_question3").is(':visible')){
				$("#license_question3").hide();
				$("#license_question4").show();
				cur_question++;
			}
			else if($("#license_question4").is(':visible')){
				$("#license_question4").hide();
				$("#license_question5").show();
				cur_question++;
			}
			else if($("#license_question5").is(':visible')){
				$("#license_question5").hide();
				$("#license_question6").show();
				cur_question++;
			}
			else if($("#license_question6").is(':visible')){
				$("#license_question6").hide();
				$("#license_question7").show();
				$("#next_question").toggle();
				cur_question++;
			}
		});

		<!--推荐排序按钮-->
		$("#sort_selection").change(function(){
			sort_val = $("#sort_selection").val();
			$.ajax({
					dataType: 'JSON',
					cache: false,
					async: true,
					type: 'POST',
					url:"{% url 'ossls:sort_license' %}",
					traditional:true,
					data:{
						sort_val:sort_val,
					},
					beforeSend:function(xhr,settings){
						xhr.setRequestHeader("X-CSRFToken","{{csrf_token}}");
					},
					success:function(result){
						sort_dict = result["sort_dict"];
						for (var i = 0; i < $("#licenselist_recommended").find("li").length; i++){
							$("#licenselist_recommended").children("li").eq(i).attr("value",result["sort_dict"][$("#licenselist_recommended").children("li").eq(i).text()]);
						}
						var sort_divlist = $("#licenselist_recommended li").get();
						if(sort_val == 'popular_desc' || sort_val == 'complex_asc'){
							sort_divlist.sort(function(a,b){
								var el_a = parseInt($(a).attr('value'));
								var el_b = parseInt($(b).attr('value'));
								if(el_a > el_b) return -1;
								if(el_a < el_b) return 1;
								return 0;
							});
						}
						else if(sort_val == 'popular_asc' || sort_val == 'complex_desc'){
							sort_divlist.sort(function(a,b){
								var el_a = parseInt($(a).attr('value'));
								var el_b = parseInt($(b).attr('value'));
								if(el_a > el_b) return 1;
								if(el_a < el_b) return -1;
								return 0;
							});
						}
						else{
							sort_divlist.sort(function(a,b){
								var el_a = parseInt($(a).attr('value'));
								var el_b = parseInt($(b).attr('value'));
								if(el_a > el_b) return -1;
								if(el_a < el_b) return 1;
								return 0;
							});
						}

						console.log(sort_divlist);
						$("#licenselist_recommended").append(sort_divlist);
					},
					error:function(){
						alert("服务端连接失败，请刷新重试");
					},
			});
		});

	</script>

{% endblock %}